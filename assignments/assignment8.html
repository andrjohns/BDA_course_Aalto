<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.211">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aki Vehtari et al.">

<title>Bayesian Data Analysis - Assignment 8</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./assignment8.html">Assignment 8</a></li></ol></nav>
      <a class="flex-grow-1" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment1.html" class="sidebar-item-text sidebar-link">Assignment 1</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment2.html" class="sidebar-item-text sidebar-link">Assignment 2</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment3.html" class="sidebar-item-text sidebar-link">Assignment 3</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment4.html" class="sidebar-item-text sidebar-link">Assignment 4</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment5.html" class="sidebar-item-text sidebar-link">Assignment 5</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment6.html" class="sidebar-item-text sidebar-link">Assignment 6</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment7.html" class="sidebar-item-text sidebar-link">Assignment 7</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment8.html" class="sidebar-item-text sidebar-link active">Assignment 8</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment9.html" class="sidebar-item-text sidebar-link">Assignment 9</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./docker.html" class="sidebar-item-text sidebar-link">How to set up docker</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#general-information" id="toc-general-information" class="nav-link active" data-scroll-target="#general-information"><span class="toc-section-number">1</span>  General information</a></li>
  <li><a href="#a-hierarchical-model-for-chicken-weight-time-series" id="toc-a-hierarchical-model-for-chicken-weight-time-series" class="nav-link" data-scroll-target="#a-hierarchical-model-for-chicken-weight-time-series"><span class="toc-section-number">2</span>  A hierarchical model for chicken weight time series</a>
  <ul class="collapse">
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="toc-section-number">2.1</span>  Exploratory data analysis</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="toc-section-number">2.2</span>  Linear regression</a></li>
  <li><a href="#log-normal-linear-regression" id="toc-log-normal-linear-regression" class="nav-link" data-scroll-target="#log-normal-linear-regression"><span class="toc-section-number">2.3</span>  Log-normal linear regression</a></li>
  <li><a href="#hierarchical-log-normal-linear-regression" id="toc-hierarchical-log-normal-linear-regression" class="nav-link" data-scroll-target="#hierarchical-log-normal-linear-regression"><span class="toc-section-number">2.4</span>  Hierarchical log-normal linear regression</a></li>
  <li><a href="#model-comparison-using-the-elpd" id="toc-model-comparison-using-the-elpd" class="nav-link" data-scroll-target="#model-comparison-using-the-elpd"><span class="toc-section-number">2.5</span>  Model comparison using the ELPD</a></li>
  <li><a href="#model-comparison-using-the-rmse" id="toc-model-comparison-using-the-rmse" class="nav-link" data-scroll-target="#model-comparison-using-the-rmse"><span class="toc-section-number">2.6</span>  Model comparison using the RMSE</a></li>
  </ul></li>
  <li><a href="#overall-quality-of-the-report" id="toc-overall-quality-of-the-report" class="nav-link" data-scroll-target="#overall-quality-of-the-report"><span class="toc-section-number">3</span>  Overall quality of the report</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Assignment 8</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">LOO-CV model comparison</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aki Vehtari et al. </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="general-information" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> General information</h1>
<p><strong>The maximum amount of points from this assignment is 6.</strong></p>
<p>We have prepared a <strong><a href="template8.html">quarto template specific for this assignment</a></strong> to help you get started.</p>
<div class="gsu">
<p>We recommend you use the <a href="docker.html">docker container</a>.</p>
</div>
<div class="callout callout-style-default callout-tip callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong>Reading instructions</strong>:</p>
<ul>
<li><a href="../BDA3_notes.html#ch6"><strong>The reading instructions for BDA3 Chapter 6</strong></a> (posterior predictive checking).</li>
<li><a href="../BDA3_notes.html#ch7"><strong>The reading instructions for BDA3 Chapter 7</strong></a> (predictive performance).</li>
<li>The <a href="https://mc-stan.org/loo/articles/loo2-with-rstan.html">’loo‘ package vignette on the basics of LOO</a> shows an example of how to modify Stan code and use the package with Stan models.</li>
<li>Also read about PSIS-LOO in the <a href="https://link.springer.com/article/10.1007/s11222-016-9696-4">PSIS-LOO paper</a>.</li>
<li><a href="https://avehtari.github.io/modelselection/CV-FAQ.html">CV-FAQ</a> includes a lot of informative answers to frequent questions and misconceptions.</li>
</ul>
<p><strong>Grading instructions:</strong></p>
<p>The grading will be done in peergrade. All grading questions and evaluations for this assignment are contained within this document in the collapsible <strong>Rubric</strong> blocks.</p>
<p><strong>Installing and using <code>CmdStanR</code>:</strong></p>
<p>See the <a href="https://avehtari.github.io/BDA_course_Aalto/demos.html">Stan demos</a> on how to use Stan in R (or Python). <span class="aalto"><a href="https://jupyter.cs.aalto.fi">jupyter.cs.aalto.fi</a> has working R and CmdStanR/RStan environment and is probably the easiest way to use Stan. The Aalto Ubuntu desktops also have the necessary libraries installed.</span> To install Stan on your laptop, run ‘install.packages("cmdstanr", repos = c("https://mc-stan.org/r-packages/", getOption("repos")))’ in R. If you encounter problems, see additional answers in <a href="https://avehtari.github.io/BDA_course_Aalto/FAQ.html"><strong>FAQ</strong></a>. <span class="aalto">If you don’t succeed in short amount of time, it is probably easier to use <a href="https://jupyter.cs.aalto.fi">jupyter.cs.aalto.fi</a>.</span></p>
<p><span class="aalto">If you use <code>jupyter.cs.aalto.fi</code>, all necessary packages have been pre-installed.</span> In your laptop, install package <code>cmdstanr</code>. Installation instructions on Linux, Mac and Windows can be found at <a href="https://mc-stan.org/cmdstanr/" class="uri">https://mc-stan.org/cmdstanr/</a>. Additional useful packages are <code>loo</code>, <code>bayesplot</code> and <code>posterior</code> (but you don’t need these in this assignment). For Python users, <code>PyStan</code>, <code>CmdStanPy</code>, and <code>ArviZ</code> packages are useful.</p>
<p>Stan manual can be found at <a href="https://mc-stan.org/users/documentation/" class="uri">https://mc-stan.org/users/documentation/</a>. From this website, you can also find a lot of other useful material about Stan.</p>
<p>If you edit files ending <code>.stan</code> in RStudio, you can click “Check” in the editor toolbar to make syntax check. This can significantly speed-up writing a working Stan model.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Reporting accuracy
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong>For posterior statistics of interest, only report digits for which the Monte Carlo standard error (MCSE) is zero.</strong></p>
<p><em>Example:</em> If you estimate <span class="math inline">\(E(\mu)=1.234\)</span> with MCSE(<span class="math inline">\(E(\mu)\)</span>) = 0.01, you should report <span class="math inline">\(E(\mu)=1.2\)</span>.</p>
<p>See lecture video 4.1, <a href="https://avehtari.github.io/BDA_course_Aalto/chapter_notes/BDA_notes_ch10.pdf">the chapter notes</a>, and <a href="https://avehtari.github.io/casestudies/Digits/digits.html">a case study</a> for more information.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Further information
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>The recommended tool in this course is R (with the IDE RStudio).</li>
<li>Instead of installing R and RStudio on you own computer, see <a href="https://avehtari.github.io/BDA_course_Aalto/FAQ.html#How_to_use_R_and_RStudio_remotely"><strong>how to use R and RStudio remotely</strong></a>.</li>
<li>If you want to install R and RStudio locally, download <a href="https://posit.co/download/rstudio-desktop/">R and RStudio</a>.</li>
<li>There are tons of tutorials, videos and introductions to R and RStudio online. You can find some initial hints from <a href="https://education.rstudio.com/"><strong>RStudio Education pages</strong></a>.</li>
<li>When working with R, we recommend writing the report using <code>quarto</code> and the provided template. The template includes the formatting instructions and how to include code and figures.</li>
<li>Instead of <code>quarto</code>, you can use other software to make the PDF report, but the the same instructions for formatting should be used.</li>
<li>Report all results in a single, <strong>anonymous</strong> *.pdf -file and submit it in <a href="peergrade.io"><strong>peergrade.io</strong></a>.</li>
<li>The course has its own R package <code>aaltobda</code> with data and functionality to simplify coding. The package is pre-installed in JupyterHub. To install the package on your own system, run the following code (upgrade="never" skips question about updating other packages):</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">install.packages</span>(<span class="st">"remotes"</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"avehtari/BDA_course_Aalto"</span>, <span class="at">subdir =</span> <span class="st">"rpackage"</span>, <span class="at">upgrade=</span><span class="st">"never"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Many of the exercises can be checked automatically using the R package <code>markmyassignment</code> (pre-installed in JupyterHub). Information on how to install and use the package can be found in <a href="https://cran.r-project.org/web/packages/markmyassignment/vignettes/markmyassignment.html">the <code>markmyassignment</code> documentation</a>. There is no need to include <code>markmyassignment</code> results in the report.</li>
<li>Recommended additional self study exercises for each chapter in BDA3 are listed in the course web page. These will help to gain deeper understanding of the topic.</li>
<li>Common questions and answers regarding installation and technical problems can be found in <a href="https://avehtari.github.io/BDA_course_Aalto/FAQ.html">Frequently Asked Questions (FAQ)</a>.</li>
<li>Deadlines for all assignments can be found on the course web page and in Peergrade. You can set email alerts for the deadlines in Peergrade settings.</li>
<li>You are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet.</li>
<li>You can copy, e.g., plotting code from the course demos, but really try to solve the actual assignment problems with your own code and explanations.</li>
<li>Do not share your answers publicly.</li>
<li>Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year.</li>
<li>Use of AI is allowed on the course, but the most of the work needs to by the student, and you need to report whether you used AI and in which way you used them (See <a href="https://www.aalto.fi/en/services/guidance-for-the-use-of-artificial-intelligence-in-teaching-and-learning-at-aalto-university">points 5 and 6 in Aalto guidelines for use of AI in teaching</a>).</li>
<li>All suspected plagiarism will be reported and investigated. See more about the <a href="https://into.aalto.fi/display/ensaannot/Aalto+University+Code+of+Academic+Integrity+and+Handling+Violations+Thereof"><strong>Aalto University Code of Academic Integrity and Handling Violations Thereof</strong></a>.</li>
<li>Do not submit empty PDFs, almost empty PDFs, copy of the questions, nonsense generated by yourself or AI, as these are just harming the other students as they can’t do peergrading for the empty or nonsense submissions. Violations of this rule will be reported and investigated in the same way was plagiarism.</li>
<li>If you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Rubric S1: General information - 7.5/100 points
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q1: </strong>
Can you open the PDF and it’s not blank nor nonsense?<br>
</li>
<li><strong>Q2: </strong>
Is the report anonymous?</li>
</ul>
</div>
</div>
</div>
</section>
<section id="a-hierarchical-model-for-chicken-weight-time-series" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> A hierarchical model for chicken weight time series</h1>
<section id="exploratory-data-analysis" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="exploratory-data-analysis"><span class="header-section-number">2.1</span> Exploratory data analysis</h2>
<p>In the first part of this assignment, you will explore the dataset <code>ChickWeight</code>. In particular, you will see what information is recorded in the dataset, and how you can use visualisation to learn more about the dataset. More information can be found on the corresponding page of the <a href="https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/ChickWeight">R documentation</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">head</span>(ChickWeight, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   weight Time Chick Diet
1      42    0     1    1
2      51    2     1    1
3      59    4     1    1
4      64    6     1    1
5      76    8     1    1
6      93   10     1    1
7     106   12     1    1
8     125   14     1    1
9     149   16     1    1
10    171   18     1    1</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.a)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Create a histogram to explore the range of chicken weights. Describe what you see in the plot. What is the qualitative range of the data?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.a)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q3: </strong>
Does the plot look correct and is it readable?</li>
<li><strong>Q4: </strong>
Has it been stated that the data is <strong>…</strong>?</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.b)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Plot the weight of each chicken over time in a line plot. Add colours based on the diet. Describe what you see in the plot.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.b)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q5: </strong>
Does the plot look correct and is it readable?</li>
<li><strong>Q6: </strong>
Has it been recognized that there is variation between <strong>…</strong> and <strong>…</strong>?</li>
</ul>
</div>
</div>
</div>
</section>
<section id="linear-regression" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="linear-regression"><span class="header-section-number">2.2</span> Linear regression</h2>
<p>In this section, you will build a model that predicts the weight of a chicken over time and depending on the diet. After sampling from the posteriors, you will use posterior predictive checks to see how well the predictions match the observations. Then you will adjust the model by adding more complexity, and check again.</p>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.c)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Using <code>brms</code>, implement a pooled linear regression with a normal model and <code>weight</code> as the predicted variable using <code>Diet</code> and <code>Time</code> as predictors. Try to use weakly informative priors.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>For the prior on <code>Time</code>, consider how much the weight of a chicken (in grams) could possibly change each day. For the priors on the effects of different diets, consider how much average weight difference would be possible between diets.</p>
<p>Note that as <code>Diet</code> is a categorical variable, the priors need to be specified for each category (apart from <code>Diet1</code> which is taken to be the baseline).</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.c)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q7: </strong>
Is the brms-formula <strong>…</strong>?</li>
<li><strong>Q8: </strong>
Is the family <strong>…</strong>?</li>
<li><strong>Q9: </strong>
Are the prior standard deviations around <strong>…</strong>?</li>
</ul>
</div>
</div>
</div>
<p>Next, you can use the <code>bayesplot</code> package to check the posterior predictions in relation to the observed data using the <a href="https://mc-stan.org/bayesplot/reference/pp_check.html"><code>pp_check</code> function</a>. The function plots the <span class="math inline">\(y\)</span> values, which are the observed data, and the <span class="math inline">\(y_\text{rep}\)</span> values, which are replicated data sets from the posterior predictive distribution.</p>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.d)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Perform the posterior predictive check with the default arguments. What do you observe? Based on the plot, do the posterior predictions encapsulate the main features of the observed data? Point out any major differences between the predictions and the observed data. Answer the following questions:</p>
<ul>
<li>Are there qualitative differences between the observed data and the predicted data?</li>
<li>Do the observed data seem quantitatively similar?</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.d)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q10: </strong>
Does the plot look correct and is it readable?</li>
<li><strong>Q11: </strong>
Has it been recognized that the predicted data include <strong>…</strong>?</li>
<li><strong>Q12: </strong>
Has it been recognized that the observed and predicted data <strong>…</strong>?</li>
</ul>
</div>
</div>
</div>
<p>The default density plot is not always informative, but <code>bayesplot</code> has different settings that can be used to create plots more appropriate for specific data.</p>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.e)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Create another plot with grouping to the PPC plot using the arguments <code>type = "intervals_grouped"</code> and <code>group = "Diet"</code>. What do you observe? Point out any major differences between the predictions and the observed data. Based on your visualisations, how could the model be improved?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.e)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q13: </strong>
Does the plot look correct and is it readable?</li>
<li><strong>Q14: </strong>
Is there at least one reasonable way to improve the model, e.g.&nbsp;<strong>…</strong>?</li>
</ul>
</div>
</div>
</div>
</section>
<section id="log-normal-linear-regression" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="log-normal-linear-regression"><span class="header-section-number">2.3</span> Log-normal linear regression</h2>
<p>Based on the identified issues from the posterior predictive check, the model can be improved. It is advisable to change only one or a few things about a model at once. At this stage, focus on changing the observation model family to better account for the observed data.</p>
<p>One option is to use the lognormal observation model, which only allows positive values. In <code>brms</code> you can change the observation model family to this by setting the argument <code>family = "lognormal"</code>. Note that when using the log-normal observation model, the regression coefficients represent the change in the log weight of a chicken. The priors have been adjusted accordingly in the template.</p>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.f)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Adjust the model, sample from the posterior and create the same two posterior predictive check plots. Comment on your observations. Does the new model better capture some aspects of the data?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">

</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.f)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q15: </strong>
Do the plots look correct and are they readable?</li>
<li><strong>Q16: </strong>
Has it been recognized that the fit to data is <strong>…</strong>?</li>
</ul>
</div>
</div>
</div>
</section>
<section id="hierarchical-log-normal-linear-regression" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="hierarchical-log-normal-linear-regression"><span class="header-section-number">2.4</span> Hierarchical log-normal linear regression</h2>
<p>The model can further be improved by directly considering potential differences in growth rate for individual chicken. Some chickens may innately grow faster than others, and this difference can be included by including both population and group level effects in to the model.</p>
<p>To include a group effect in <code>brms</code>, the code <code>+ (predictor|group)</code> can be added to the model formula. In this case, the predictor is <code>Time</code> and the group is <code>Chick</code>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.g)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Create the same two plots as for the previous models. Comment on what you see. Do the predictions seem to better capture the observed data? Are there remaining discrepancies between the predictions and observed data that could be addressed?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.g)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q17: </strong>
Do the plots look correct and are they readable?</li>
<li><strong>Q18: </strong>
Has it been recognized that the fit to data is <strong>…</strong>?</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.h)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Have you encountered any convergence issues in the above models? Report and comment.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.h)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q19: </strong>
Has there been a potentially brief discussion of the standard convergence criteria (Rhat, ESS, divergent transitions) for all models?</li>
</ul>
</div>
</div>
</div>
</section>
<section id="model-comparison-using-the-elpd" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="model-comparison-using-the-elpd"><span class="header-section-number">2.5</span> Model comparison using the ELPD</h2>
<p>There are many ways of comparing models<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. Commonly, we evaluate point predictions, such as the mean of the predictive distribution<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, or accuracy of the whole posterior predictive. Whether we prioritise point or density predictive accuracy may serve different purposes and lead to different outcomes for model choice <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. It is common, however, to report predictive accuracy via log-scores and point-predictive accuracy via root-mean-squared-error based on the empirical average of the predictive distribution. To cross-validate both metrics on left out observations without need to sample from each leave-one-out posterior, we use Pareto-smoothed importance sampling as discussed in the course materials (see Lecture 9).</p>
<p>We start comparing models based on the log-score. Use <code>loo::loo()</code> and <code>loo::loo_compare()</code> to quantify the differences in predictive performance.</p>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.i)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Answer the following questions using <code>loo</code>/<code>loo_compare</code>:</p>
<ul>
<li>Which model has the best predictive performance?</li>
<li>Does the uncertainty influence the decision of which model is best?</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.i)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q20: </strong>
Do the results look correct and have they been presented in a readable way? They should be roughly <strong>…</strong>.</li>
<li><strong>Q21: </strong>
Has it been recognized that the best model is <strong>…</strong> and that the uncertainty is <strong>…</strong>?</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.j)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Assess whether the approximation to the LOO-CV distributions are reliable. Consult the <span class="math inline">\(\hat{k}\)</span> statistic which informs on the reliability of PSIS computation in PSIS-LOO. Plot the <span class="math inline">\(\hat{k}\)</span> values for each model against the data point ID and discuss. Are they as expected?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>For hierarchical models, it may be more important to think about how well the individual group is predicted and how many observations there are in a group compared to the number of parameters estimated. Also check out <a href="https://avehtari.github.io/modelselection/CV-FAQ.html#17_What_to_do_if_I_have_high_Pareto_(hat%7Bk%7D)%E2%80%99s">CV-FAQ on high Pareto-<span class="math inline">\(\hat{k}\)</span> values</a>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.j)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q22: </strong>
Do the plots look correct and are they readable?</li>
<li><strong>Q23: </strong>
Has it been explained why the <span class="math inline">\(\hat{k}\)</span> values are highest for the <strong>…</strong>? <strong>…</strong></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.k)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Perform a PPC for the hierarchical model for</p>
<ul>
<li>a few of the chickens with the highest <span class="math inline">\(\hat{k}\)</span> values and</li>
<li>a few of the chickens with the lowest <span class="math inline">\(\hat{k}\)</span> values</li>
</ul>
<p>using the code in the template. What do you observe?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.k)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q24: </strong>
Does the plot look correct and is it readable?</li>
<li><strong>Q25: </strong>
Has it been recognized that the chickens with high <span class="math inline">\(\hat{k}\)</span> values <strong>…</strong>?</li>
</ul>
</div>
</div>
</div>
</section>
<section id="model-comparison-using-the-rmse" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="model-comparison-using-the-rmse"><span class="header-section-number">2.6</span> Model comparison using the RMSE</h2>
<div class="callout callout-style-default callout-warning no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subtask 2.l)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Use the function in the template to compare the RMSE and the LOO-RMSE for the three models. Explain the difference between the RMSE and the LOO-RMSE in 1–3 sentences. Is one generally lower than the other? Why?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Subrubric 2.l)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q26: </strong>
Do the results look correct and have they been presented in a readable way?</li>
<li><strong>Q27: </strong>
Has it been recognized that the RMSE is <strong>…</strong> than the LOO-RMSE because <strong>…</strong>?</li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="overall-quality-of-the-report" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Overall quality of the report</h1>
<div class="callout callout-style-default callout-note no-icon callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Rubric S3: Overall quality of the report - 7.5/100 points
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q28: </strong>
Does the report include whether AI was used and if was used explanation on how it was used?
<ul>
<li>No</li>
<li>Yes</li>
</ul></li>
<li><strong>Q29: </strong>
Does the report follow the formatting instructions?
<ul>
<li>Not at all</li>
<li>Little</li>
<li>Mostly</li>
<li>Yes</li>
</ul></li>
<li><strong>Q30: </strong>
In case the report doesn’t fully follow the formatting instructions, specify the formatting instruction that is not followed. If applicable, specify the page of the report, where this difference in formatting is visible.</li>
<li><strong>Q31: </strong>
Please provide also feedback on the presentation (e.g.&nbsp;text, layout, flow of the responses, figures, figure captions). Part of the course is practicing making data analysis reports. By providing feedback on the report presentation and other students can learn what they can improve or what they already did well. You should be able to provide constructive or positive feedback for all non-empty reports. If you think the report is perfect, and you can’t come up with any suggestions how to improve, you can provide feedback on what you liked and why you think the report is better than yours.</li>
</ul>
</div>
</div>
</div>


<!-- -->

</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>In principle, when comparing models based on accuracy in predictions or parameter estimation (if true parameter values are available to you, as e.g.&nbsp;in simulation studies), we want to use so called strictly proper scoring rules that will always indicate when a “better” model is better and the score reaches its uniquely defined best value at the “true” model, if it is also well defined. See <a href="https://www.tandfonline.com/doi/abs/10.1198/016214506000001437"><strong>Gneiting and Raftery, (2007)</strong></a> for and in depth treatment of this topic.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>NOT predictions based on the mean of the posterior parameters, but first generating the predictive distribution and then computing an average.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>For instance, a unimodal and bimodal predictive density may have the same expected value, but very different areas of high posterior density and therefore very different log-scores.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb4" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">---</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="an">title:</span><span class="co"> "Assignment 8"</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="an">subtitle:</span><span class="co"> "LOO-CV model comparison"</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="an">author:</span><span class="co"> "Aki Vehtari et al."</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="an">format:</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">  html:</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">    toc: true</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">    code-tools: true</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">    # standalone: true</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">    # self-contained: true</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">    # embed-resources: true</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">    number-sections: true</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">    mainfont: Georgia, serif</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="co">    #fontsize: 12pt</span></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="co">    page-layout: article</span></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co"># reference-location: margin</span></span>
<span id="cb4-18"><a href="#cb4-18"></a><span class="co"># citation-location: margin</span></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="an">comments:</span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co">  hypothesis: true</span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="an">editor:</span><span class="co"> source</span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="an">filters:</span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co">  - assignments.lua</span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="co">  - include-code-files.lua</span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="an">execute:</span></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="co">  daemon: 999999</span></span>
<span id="cb4-27"><a href="#cb4-27"></a><span class="co">---</span></span>
<span id="cb4-28"><a href="#cb4-28"></a></span>
<span id="cb4-29"><a href="#cb4-29"></a><span class="fu"># General information</span></span>
<span id="cb4-30"><a href="#cb4-30"></a></span>
<span id="cb4-31"><a href="#cb4-31"></a>**The maximum amount of points from this assignment is 6.**</span>
<span id="cb4-32"><a href="#cb4-32"></a></span>
<span id="cb4-33"><a href="#cb4-33"></a>We have prepared a **[quarto template specific for this</span>
<span id="cb4-34"><a href="#cb4-34"></a>assignment](template8.html)** to help you get started.</span>
<span id="cb4-35"><a href="#cb4-35"></a></span>
<span id="cb4-36"><a href="#cb4-36"></a>:::{.gsu}</span>
<span id="cb4-37"><a href="#cb4-37"></a>We recommend you use the <span class="co">[</span><span class="ot">docker container</span><span class="co">](docker.html)</span>. </span>
<span id="cb4-38"><a href="#cb4-38"></a>:::</span>
<span id="cb4-39"><a href="#cb4-39"></a></span>
<span id="cb4-40"><a href="#cb4-40"></a></span>
<span id="cb4-41"><a href="#cb4-41"></a>:::{.hint}</span>
<span id="cb4-42"><a href="#cb4-42"></a>**Reading instructions**:</span>
<span id="cb4-43"><a href="#cb4-43"></a></span>
<span id="cb4-44"><a href="#cb4-44"></a><span class="ss">- </span><span class="co">[</span><span class="ot">**The reading instructions for BDA3 Chapter 6**</span><span class="co">](../BDA3_notes.html#ch6)</span> (posterior predictive checking).</span>
<span id="cb4-45"><a href="#cb4-45"></a><span class="ss">- </span><span class="co">[</span><span class="ot">**The reading instructions for BDA3 Chapter 7**</span><span class="co">](../BDA3_notes.html#ch7)</span> (predictive performance).</span>
<span id="cb4-46"><a href="#cb4-46"></a><span class="ss">- </span>The <span class="co">[</span><span class="ot">‘loo‘ package vignette on the basics of LOO</span><span class="co">](https://mc-stan.org/loo/articles/loo2-with-rstan.html)</span></span>
<span id="cb4-47"><a href="#cb4-47"></a>shows an example of how to modify Stan code and use the package with Stan models.</span>
<span id="cb4-48"><a href="#cb4-48"></a><span class="ss">- </span>Also read</span>
<span id="cb4-49"><a href="#cb4-49"></a>about PSIS-LOO in the <span class="co">[</span><span class="ot">PSIS-LOO paper</span><span class="co">](https://link.springer.com/article/10.1007/s11222-016-9696-4)</span>.</span>
<span id="cb4-50"><a href="#cb4-50"></a><span class="ss">- </span><span class="co">[</span><span class="ot">CV-FAQ</span><span class="co">](https://avehtari.github.io/modelselection/CV-FAQ.html)</span> includes a lot of informative answers to frequent questions and misconceptions.</span>
<span id="cb4-51"><a href="#cb4-51"></a></span>
<span id="cb4-52"><a href="#cb4-52"></a>{{&lt; include grading_instructions.md &gt;}}</span>
<span id="cb4-53"><a href="#cb4-53"></a></span>
<span id="cb4-54"><a href="#cb4-54"></a>{{&lt; include cmdstanr.md &gt;}}</span>
<span id="cb4-55"><a href="#cb4-55"></a>:::</span>
<span id="cb4-56"><a href="#cb4-56"></a></span>
<span id="cb4-57"><a href="#cb4-57"></a>{{&lt; include reporting_accuracy.md &gt;}}</span>
<span id="cb4-58"><a href="#cb4-58"></a></span>
<span id="cb4-59"><a href="#cb4-59"></a>{{&lt; include general_info.md &gt;}}</span>
<span id="cb4-60"><a href="#cb4-60"></a></span>
<span id="cb4-61"><a href="#cb4-61"></a></span>
<span id="cb4-62"><a href="#cb4-62"></a><span class="fu"># A hierarchical model for chicken weight time series</span></span>
<span id="cb4-63"><a href="#cb4-63"></a></span>
<span id="cb4-64"><a href="#cb4-64"></a><span class="fu">## Exploratory data analysis</span></span>
<span id="cb4-65"><a href="#cb4-65"></a></span>
<span id="cb4-66"><a href="#cb4-66"></a>In the first part of this assignment, you will explore the dataset <span class="in">`ChickWeight`</span>. In particular, you will see what information is recorded in the dataset, and how you can use visualisation to learn more about the dataset. More information can be found on the corresponding page of the <span class="co">[</span><span class="ot">R documentation</span><span class="co">](https://www.rdocumentation.org/packages/datasets/versions/3.6.2/topics/ChickWeight)</span>.</span>
<span id="cb4-67"><a href="#cb4-67"></a></span>
<span id="cb4-70"><a href="#cb4-70"></a><span class="in">```{r}</span></span>
<span id="cb4-71"><a href="#cb4-71"></a><span class="fu">head</span>(ChickWeight, <span class="dv">10</span>)</span>
<span id="cb4-72"><a href="#cb4-72"></a><span class="in">```</span></span>
<span id="cb4-73"><a href="#cb4-73"></a></span>
<span id="cb4-74"><a href="#cb4-74"></a>:::{.subtask letter=a}</span>
<span id="cb4-75"><a href="#cb4-75"></a>Create a histogram to explore the range of chicken weights. </span>
<span id="cb4-76"><a href="#cb4-76"></a>Describe what you see in the plot. What is the qualitative range of the data?</span>
<span id="cb4-77"><a href="#cb4-77"></a>:::</span>
<span id="cb4-78"><a href="#cb4-78"></a></span>
<span id="cb4-79"><a href="#cb4-79"></a></span>
<span id="cb4-80"><a href="#cb4-80"></a>:::{.subrubric}</span>
<span id="cb4-81"><a href="#cb4-81"></a><span class="ss">* </span>Does the plot look correct and is it readable?</span>
<span id="cb4-82"><a href="#cb4-82"></a><span class="ss">* </span>Has it been stated that the data is **...**?</span>
<span id="cb4-83"><a href="#cb4-83"></a>:::</span>
<span id="cb4-84"><a href="#cb4-84"></a></span>
<span id="cb4-85"><a href="#cb4-85"></a>:::{.subtask}</span>
<span id="cb4-86"><a href="#cb4-86"></a>Plot the weight of each chicken over time in a line plot. Add colours based on the diet.</span>
<span id="cb4-87"><a href="#cb4-87"></a>Describe what you see in the plot. </span>
<span id="cb4-88"><a href="#cb4-88"></a>:::</span>
<span id="cb4-89"><a href="#cb4-89"></a></span>
<span id="cb4-90"><a href="#cb4-90"></a></span>
<span id="cb4-91"><a href="#cb4-91"></a>:::{.subrubric}</span>
<span id="cb4-92"><a href="#cb4-92"></a><span class="ss">* </span>Does the plot look correct and is it readable?</span>
<span id="cb4-93"><a href="#cb4-93"></a><span class="ss">* </span>Has it been recognized that there is variation between **...** and **...**?</span>
<span id="cb4-94"><a href="#cb4-94"></a>:::</span>
<span id="cb4-95"><a href="#cb4-95"></a></span>
<span id="cb4-96"><a href="#cb4-96"></a><span class="fu">## Linear regression</span></span>
<span id="cb4-97"><a href="#cb4-97"></a></span>
<span id="cb4-98"><a href="#cb4-98"></a>In this section, you will build a model that predicts the weight of a</span>
<span id="cb4-99"><a href="#cb4-99"></a>chicken over time and depending on the diet. After sampling from the posteriors, you</span>
<span id="cb4-100"><a href="#cb4-100"></a>will use posterior predictive checks to see how well the predictions</span>
<span id="cb4-101"><a href="#cb4-101"></a>match the observations. Then you will adjust the model by adding more</span>
<span id="cb4-102"><a href="#cb4-102"></a>complexity, and check again.</span>
<span id="cb4-103"><a href="#cb4-103"></a></span>
<span id="cb4-104"><a href="#cb4-104"></a>::: {.subtask}</span>
<span id="cb4-105"><a href="#cb4-105"></a>Using <span class="in">`brms`</span>, implement a pooled linear regression with a normal</span>
<span id="cb4-106"><a href="#cb4-106"></a>model and <span class="in">`weight`</span> as the predicted</span>
<span id="cb4-107"><a href="#cb4-107"></a>variable using <span class="in">`Diet`</span> and <span class="in">`Time`</span> as predictors. Try to use weakly informative priors.</span>
<span id="cb4-108"><a href="#cb4-108"></a>:::</span>
<span id="cb4-109"><a href="#cb4-109"></a>::: {.hint}</span>
<span id="cb4-110"><a href="#cb4-110"></a>For the prior on <span class="in">`Time`</span>, consider how much the weight of a chicken (in grams) could possibly</span>
<span id="cb4-111"><a href="#cb4-111"></a>change each day. For the priors on the effects of different diets,</span>
<span id="cb4-112"><a href="#cb4-112"></a>consider how much average weight difference would be possible between</span>
<span id="cb4-113"><a href="#cb4-113"></a>diets.</span>
<span id="cb4-114"><a href="#cb4-114"></a></span>
<span id="cb4-115"><a href="#cb4-115"></a>Note that as <span class="in">`Diet`</span> is a categorical variable, the priors need to be</span>
<span id="cb4-116"><a href="#cb4-116"></a>specified for each category (apart from <span class="in">`Diet1`</span> which is taken to be</span>
<span id="cb4-117"><a href="#cb4-117"></a>the baseline).</span>
<span id="cb4-118"><a href="#cb4-118"></a>:::</span>
<span id="cb4-119"><a href="#cb4-119"></a></span>
<span id="cb4-120"><a href="#cb4-120"></a></span>
<span id="cb4-121"><a href="#cb4-121"></a>:::{.subrubric}</span>
<span id="cb4-122"><a href="#cb4-122"></a><span class="ss">* </span>Is the brms-formula **...**?</span>
<span id="cb4-123"><a href="#cb4-123"></a><span class="ss">* </span>Is the family **...**?</span>
<span id="cb4-124"><a href="#cb4-124"></a><span class="ss">* </span>Are the prior standard deviations around **...**?</span>
<span id="cb4-125"><a href="#cb4-125"></a>:::</span>
<span id="cb4-126"><a href="#cb4-126"></a></span>
<span id="cb4-127"><a href="#cb4-127"></a></span>
<span id="cb4-128"><a href="#cb4-128"></a>Next, you can use the <span class="in">`bayesplot`</span> package to check the posterior</span>
<span id="cb4-129"><a href="#cb4-129"></a>predictions in relation to the observed data using the <span class="co">[</span><span class="ot">`pp_check` function</span><span class="co">](https://mc-stan.org/bayesplot/reference/pp_check.html)</span>. </span>
<span id="cb4-130"><a href="#cb4-130"></a>The function plots the $y$ values, which are the observed data, </span>
<span id="cb4-131"><a href="#cb4-131"></a>and the $y_\text{rep}$ values, which are replicated data sets from the</span>
<span id="cb4-132"><a href="#cb4-132"></a>posterior predictive distribution.</span>
<span id="cb4-133"><a href="#cb4-133"></a></span>
<span id="cb4-134"><a href="#cb4-134"></a>:::{.subtask}</span>
<span id="cb4-135"><a href="#cb4-135"></a>Perform the posterior predictive check with the default arguments.</span>
<span id="cb4-136"><a href="#cb4-136"></a>What do you observe? Based on the plot, do the posterior predictions</span>
<span id="cb4-137"><a href="#cb4-137"></a>encapsulate the main features of the observed data? Point out any</span>
<span id="cb4-138"><a href="#cb4-138"></a>major differences between the predictions and the observed data.</span>
<span id="cb4-139"><a href="#cb4-139"></a>Answer the following questions:</span>
<span id="cb4-140"><a href="#cb4-140"></a></span>
<span id="cb4-141"><a href="#cb4-141"></a><span class="ss">* </span>Are there qualitative differences between the observed data and the predicted data?</span>
<span id="cb4-142"><a href="#cb4-142"></a><span class="ss">* </span>Do the observed data seem quantitatively similar?</span>
<span id="cb4-143"><a href="#cb4-143"></a>:::</span>
<span id="cb4-144"><a href="#cb4-144"></a></span>
<span id="cb4-145"><a href="#cb4-145"></a></span>
<span id="cb4-146"><a href="#cb4-146"></a>:::{.subrubric}</span>
<span id="cb4-147"><a href="#cb4-147"></a><span class="ss">* </span>Does the plot look correct and is it readable?</span>
<span id="cb4-148"><a href="#cb4-148"></a><span class="ss">* </span>Has it been recognized that the predicted data include **...**?</span>
<span id="cb4-149"><a href="#cb4-149"></a><span class="ss">* </span>Has it been recognized that the observed and predicted data **...**?</span>
<span id="cb4-150"><a href="#cb4-150"></a>:::</span>
<span id="cb4-151"><a href="#cb4-151"></a></span>
<span id="cb4-152"><a href="#cb4-152"></a>The default density plot is not always informative, but <span class="in">`bayesplot`</span></span>
<span id="cb4-153"><a href="#cb4-153"></a>has different settings that can be used to create plots more</span>
<span id="cb4-154"><a href="#cb4-154"></a>appropriate for specific data.</span>
<span id="cb4-155"><a href="#cb4-155"></a></span>
<span id="cb4-156"><a href="#cb4-156"></a>:::{.subtask}</span>
<span id="cb4-157"><a href="#cb4-157"></a>Create another plot with grouping to the PPC plot using the arguments</span>
<span id="cb4-158"><a href="#cb4-158"></a><span class="in">`type = "intervals_grouped"`</span> and <span class="in">`group = "Diet"`</span>.</span>
<span id="cb4-159"><a href="#cb4-159"></a>What do you observe? Point out any major differences</span>
<span id="cb4-160"><a href="#cb4-160"></a>between the predictions and the observed data.</span>
<span id="cb4-161"><a href="#cb4-161"></a>Based on your visualisations, how could the model be improved?</span>
<span id="cb4-162"><a href="#cb4-162"></a>:::</span>
<span id="cb4-163"><a href="#cb4-163"></a></span>
<span id="cb4-164"><a href="#cb4-164"></a></span>
<span id="cb4-165"><a href="#cb4-165"></a>:::{.subrubric}</span>
<span id="cb4-166"><a href="#cb4-166"></a><span class="ss">* </span>Does the plot look correct and is it readable?</span>
<span id="cb4-167"><a href="#cb4-167"></a><span class="ss">* </span>Is there at least one reasonable way to improve the model, e.g. **...**?</span>
<span id="cb4-168"><a href="#cb4-168"></a>:::</span>
<span id="cb4-169"><a href="#cb4-169"></a></span>
<span id="cb4-170"><a href="#cb4-170"></a><span class="fu">## Log-normal linear regression</span></span>
<span id="cb4-171"><a href="#cb4-171"></a></span>
<span id="cb4-172"><a href="#cb4-172"></a>Based on the identified issues from the posterior predictive check,</span>
<span id="cb4-173"><a href="#cb4-173"></a>the model can be improved. It is advisable to change only one or a few</span>
<span id="cb4-174"><a href="#cb4-174"></a>things about a model at once. At this stage, focus on changing the</span>
<span id="cb4-175"><a href="#cb4-175"></a>observation model family to better account for the observed data.</span>
<span id="cb4-176"><a href="#cb4-176"></a></span>
<span id="cb4-177"><a href="#cb4-177"></a>One option is to use the lognormal observation model, which only allows</span>
<span id="cb4-178"><a href="#cb4-178"></a>positive values. In <span class="in">`brms`</span> you can change the observation model family</span>
<span id="cb4-179"><a href="#cb4-179"></a>to this by setting the argument <span class="in">`family = "lognormal"`</span>.</span>
<span id="cb4-180"><a href="#cb4-180"></a>Note that when using the log-normal observation model, the regression</span>
<span id="cb4-181"><a href="#cb4-181"></a>coefficients represent the change in the log weight of a chicken. The</span>
<span id="cb4-182"><a href="#cb4-182"></a>priors have been adjusted accordingly in the template.</span>
<span id="cb4-183"><a href="#cb4-183"></a></span>
<span id="cb4-184"><a href="#cb4-184"></a>::: {.subtask}</span>
<span id="cb4-185"><a href="#cb4-185"></a>Adjust the model, sample from the posterior and create the same two posterior predictive</span>
<span id="cb4-186"><a href="#cb4-186"></a>check plots. Comment on your observations. Does the new model better</span>
<span id="cb4-187"><a href="#cb4-187"></a>capture some aspects of the data?</span>
<span id="cb4-188"><a href="#cb4-188"></a>:::</span>
<span id="cb4-189"><a href="#cb4-189"></a>::: {.hint}</span>
<span id="cb4-190"><a href="#cb4-190"></a>:::</span>
<span id="cb4-191"><a href="#cb4-191"></a></span>
<span id="cb4-192"><a href="#cb4-192"></a></span>
<span id="cb4-193"><a href="#cb4-193"></a>:::{.subrubric}</span>
<span id="cb4-194"><a href="#cb4-194"></a><span class="ss">* </span>Do the plots look correct and are they readable?</span>
<span id="cb4-195"><a href="#cb4-195"></a><span class="ss">* </span>Has it been recognized that the fit to data is **...**?</span>
<span id="cb4-196"><a href="#cb4-196"></a>:::</span>
<span id="cb4-197"><a href="#cb4-197"></a></span>
<span id="cb4-198"><a href="#cb4-198"></a><span class="fu">## Hierarchical log-normal linear regression</span></span>
<span id="cb4-199"><a href="#cb4-199"></a></span>
<span id="cb4-200"><a href="#cb4-200"></a>The model can further be improved by directly considering potential</span>
<span id="cb4-201"><a href="#cb4-201"></a>differences in growth rate for individual chicken. Some chickens may</span>
<span id="cb4-202"><a href="#cb4-202"></a>innately grow faster than others, and this difference can be included</span>
<span id="cb4-203"><a href="#cb4-203"></a>by including both population and group level effects in to the model.</span>
<span id="cb4-204"><a href="#cb4-204"></a></span>
<span id="cb4-205"><a href="#cb4-205"></a>To include a group effect in <span class="in">`brms`</span>, the code `+</span>
<span id="cb4-206"><a href="#cb4-206"></a>(predictor|group)` can be added to the model formula. In this case,</span>
<span id="cb4-207"><a href="#cb4-207"></a>the predictor is <span class="in">`Time`</span> and the group is <span class="in">`Chick`</span>.</span>
<span id="cb4-208"><a href="#cb4-208"></a></span>
<span id="cb4-209"><a href="#cb4-209"></a>::: {.subtask}</span>
<span id="cb4-210"><a href="#cb4-210"></a>Create the same two plots as for the previous models. Comment on what</span>
<span id="cb4-211"><a href="#cb4-211"></a>you see. Do the predictions seem to better capture the observed data?</span>
<span id="cb4-212"><a href="#cb4-212"></a>Are there remaining discrepancies between the predictions and observed</span>
<span id="cb4-213"><a href="#cb4-213"></a>data that could be addressed?</span>
<span id="cb4-214"><a href="#cb4-214"></a>:::</span>
<span id="cb4-215"><a href="#cb4-215"></a></span>
<span id="cb4-216"><a href="#cb4-216"></a>:::{.subrubric}</span>
<span id="cb4-217"><a href="#cb4-217"></a><span class="ss">* </span>Do the plots look correct and are they readable?</span>
<span id="cb4-218"><a href="#cb4-218"></a><span class="ss">* </span>Has it been recognized that the fit to data is **...**?</span>
<span id="cb4-219"><a href="#cb4-219"></a>:::</span>
<span id="cb4-220"><a href="#cb4-220"></a></span>
<span id="cb4-221"><a href="#cb4-221"></a>:::{.subtask}</span>
<span id="cb4-222"><a href="#cb4-222"></a>Have you encountered any convergence issues in the above models? Report and comment.</span>
<span id="cb4-223"><a href="#cb4-223"></a>:::</span>
<span id="cb4-224"><a href="#cb4-224"></a>:::{.subrubric}</span>
<span id="cb4-225"><a href="#cb4-225"></a><span class="ss">* </span>Has there been a potentially brief discussion of the standard convergence criteria (Rhat, ESS, divergent transitions) for all models?</span>
<span id="cb4-226"><a href="#cb4-226"></a>:::</span>
<span id="cb4-227"><a href="#cb4-227"></a></span>
<span id="cb4-228"><a href="#cb4-228"></a><span class="fu">## Model comparison using the ELPD</span></span>
<span id="cb4-229"><a href="#cb4-229"></a></span>
<span id="cb4-230"><a href="#cb4-230"></a>There are many ways of comparing models<span class="ot">[^footnote1]</span>. Commonly, we evaluate point predictions, such as the mean of the predictive distribution<span class="ot">[^footnote2]</span>, or accuracy of the whole posterior predictive. Whether we prioritise point or density predictive accuracy may serve different purposes and lead to different outcomes for model choice <span class="ot">[^footnote3]</span>. It is common, however, to report predictive accuracy via log-scores and point-predictive accuracy via root-mean-squared-error based on the empirical average of the predictive distribution. To cross-validate both metrics on left out observations without need to sample from each leave-one-out posterior, we use Pareto-smoothed importance sampling as discussed in the course materials (see Lecture 9). </span>
<span id="cb4-231"><a href="#cb4-231"></a></span>
<span id="cb4-232"><a href="#cb4-232"></a>We start comparing models based on the log-score. Use <span class="in">`loo::loo()`</span> and <span class="in">`loo::loo_compare()`</span> to quantify the differences in predictive performance.</span>
<span id="cb4-233"><a href="#cb4-233"></a></span>
<span id="cb4-234"><a href="#cb4-234"></a><span class="ot">[^footnote1]: </span>In principle, when comparing models based on accuracy in predictions or parameter estimation (if true parameter values are available to you, as e.g. in simulation studies), we want to use so called strictly proper scoring rules that will always indicate when a "better" model is better and the score reaches its uniquely defined best value at the "true" model, if it is also well defined. See <span class="co">[</span><span class="ot">**Gneiting and Raftery, (2007)**</span><span class="co">](https://www.tandfonline.com/doi/abs/10.1198/016214506000001437)</span> for and in depth treatment of this topic.</span>
<span id="cb4-235"><a href="#cb4-235"></a></span>
<span id="cb4-236"><a href="#cb4-236"></a><span class="ot">[^footnote2]: </span>NOT predictions based on the mean of the posterior parameters, but first generating the predictive distribution and then computing an average.</span>
<span id="cb4-237"><a href="#cb4-237"></a></span>
<span id="cb4-238"><a href="#cb4-238"></a><span class="ot">[^footnote3]: </span>For instance, a unimodal and bimodal predictive density may have the same expected value, but very different areas of high posterior density and therefore very different log-scores.</span>
<span id="cb4-239"><a href="#cb4-239"></a></span>
<span id="cb4-240"><a href="#cb4-240"></a>:::{.subtask}</span>
<span id="cb4-241"><a href="#cb4-241"></a>Answer the following questions using <span class="in">`loo`</span>/<span class="in">`loo_compare`</span>:</span>
<span id="cb4-242"><a href="#cb4-242"></a></span>
<span id="cb4-243"><a href="#cb4-243"></a><span class="ss">* </span>Which model has the best predictive performance? </span>
<span id="cb4-244"><a href="#cb4-244"></a><span class="ss">* </span>Does the uncertainty influence the decision of which model is best?</span>
<span id="cb4-245"><a href="#cb4-245"></a>:::</span>
<span id="cb4-246"><a href="#cb4-246"></a></span>
<span id="cb4-247"><a href="#cb4-247"></a></span>
<span id="cb4-248"><a href="#cb4-248"></a>:::{.subrubric}</span>
<span id="cb4-249"><a href="#cb4-249"></a><span class="ss">* </span>Do the results look correct and have they been presented in a readable way? They should be roughly **...**.</span>
<span id="cb4-250"><a href="#cb4-250"></a><span class="ss">* </span>Has it been recognized that the best model is **...** and that the uncertainty is **...**?</span>
<span id="cb4-251"><a href="#cb4-251"></a>:::</span>
<span id="cb4-252"><a href="#cb4-252"></a>:::{.subtask}</span>
<span id="cb4-253"><a href="#cb4-253"></a>Assess whether the approximation to the LOO-CV distributions are reliable.</span>
<span id="cb4-254"><a href="#cb4-254"></a>Consult the $\hat{k}$ statistic which informs on the reliability of PSIS computation in PSIS-LOO. </span>
<span id="cb4-255"><a href="#cb4-255"></a>Plot the $\hat{k}$ values for each model against the data point ID and discuss.</span>
<span id="cb4-256"><a href="#cb4-256"></a>Are they as expected?</span>
<span id="cb4-257"><a href="#cb4-257"></a>:::</span>
<span id="cb4-258"><a href="#cb4-258"></a>:::{.hint}</span>
<span id="cb4-259"><a href="#cb4-259"></a>For hierarchical models, it may be more important to think about how well the individual group is predicted and how many observations there are in a group compared to the number of parameters estimated. Also check out <span class="co">[</span><span class="ot">CV-FAQ on high Pareto-$\hat{k}$ values</span><span class="co">]</span>(https://avehtari.github.io/modelselection/CV-FAQ.html#17_What_to_do_if_I_have_high_Pareto_(hat{k})%E2%80%99s).</span>
<span id="cb4-260"><a href="#cb4-260"></a>:::</span>
<span id="cb4-261"><a href="#cb4-261"></a></span>
<span id="cb4-262"><a href="#cb4-262"></a> </span>
<span id="cb4-263"><a href="#cb4-263"></a>:::{.subrubric}</span>
<span id="cb4-264"><a href="#cb4-264"></a><span class="ss">* </span>Do the plots look correct and are they readable?</span>
<span id="cb4-265"><a href="#cb4-265"></a><span class="ss">* </span>Has it been explained why the $\hat{k}$ values are highest for the **...**? **...**</span>
<span id="cb4-266"><a href="#cb4-266"></a>:::</span>
<span id="cb4-267"><a href="#cb4-267"></a>:::{.subtask}</span>
<span id="cb4-268"><a href="#cb4-268"></a>Perform a PPC for the hierarchical model for </span>
<span id="cb4-269"><a href="#cb4-269"></a></span>
<span id="cb4-270"><a href="#cb4-270"></a><span class="ss">* </span>a few of the chickens with the highest $\hat{k}$ values and</span>
<span id="cb4-271"><a href="#cb4-271"></a><span class="ss">* </span>a few of the chickens with the lowest $\hat{k}$ values</span>
<span id="cb4-272"><a href="#cb4-272"></a></span>
<span id="cb4-273"><a href="#cb4-273"></a>using the code in the template. What do you observe?</span>
<span id="cb4-274"><a href="#cb4-274"></a>:::</span>
<span id="cb4-275"><a href="#cb4-275"></a></span>
<span id="cb4-276"><a href="#cb4-276"></a></span>
<span id="cb4-277"><a href="#cb4-277"></a></span>
<span id="cb4-278"><a href="#cb4-278"></a>:::{.subrubric}</span>
<span id="cb4-279"><a href="#cb4-279"></a><span class="ss">* </span>Does the plot look correct and is it readable?</span>
<span id="cb4-280"><a href="#cb4-280"></a><span class="ss">* </span>Has it been recognized that the chickens with high $\hat{k}$ values **...**?</span>
<span id="cb4-281"><a href="#cb4-281"></a>:::</span>
<span id="cb4-282"><a href="#cb4-282"></a></span>
<span id="cb4-283"><a href="#cb4-283"></a><span class="fu">## Model comparison using the RMSE</span></span>
<span id="cb4-284"><a href="#cb4-284"></a></span>
<span id="cb4-285"><a href="#cb4-285"></a>:::{.subtask}</span>
<span id="cb4-286"><a href="#cb4-286"></a>Use the function in the template to compare the RMSE and the LOO-RMSE for the three models.</span>
<span id="cb4-287"><a href="#cb4-287"></a>Explain the difference between the RMSE and the LOO-RMSE in 1--3 sentences. Is one generally lower than the other? Why?</span>
<span id="cb4-288"><a href="#cb4-288"></a>:::</span>
<span id="cb4-289"><a href="#cb4-289"></a></span>
<span id="cb4-290"><a href="#cb4-290"></a></span>
<span id="cb4-291"><a href="#cb4-291"></a>:::{.subrubric}</span>
<span id="cb4-292"><a href="#cb4-292"></a><span class="ss">* </span>Do the results look correct and have they been presented in a readable way?</span>
<span id="cb4-293"><a href="#cb4-293"></a><span class="ss">* </span>Has it been recognized that the RMSE is **...** than the LOO-RMSE because **...**?</span>
<span id="cb4-294"><a href="#cb4-294"></a>:::</span>
<span id="cb4-295"><a href="#cb4-295"></a></span>
<span id="cb4-296"><a href="#cb4-296"></a>{{&lt; include overall_quality.md &gt;}}</span>
<span id="cb4-297"><a href="#cb4-297"></a>  </span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>