{
  "hash": "aa7e730f3dc53a44adb7bd8005fbb25d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 4\"\nauthor: anonymous # <-- hand in anonymously\nformat:\n  html:\n    toc: true\n    code-tools: true\n    code-line-numbers: true\n    number-sections: true\n    mainfont: Georgia, serif\n    page-layout: article\n  pdf:\n    geometry:\n    - left=1cm,top=1cm,bottom=1cm,right=7cm\n    number-sections: true\n    code-annotations: none\neditor: source\n---\n\n\n\n\n\n\n\n# General information\n\n:::: {.content-hidden when-format=\"pdf\"}\n::: {.callout-warning collapse=false}\n\n## Setup\n\n\n*This block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission.*\n**Make sure that this does not get displayed in the PDF!**\n\n\n\n\nThis is the template for [assignment 4](assignment4.html). You can download the [qmd-file](https://avehtari.github.io/BDA_course_Aalto/assignments/template4.qmd) or copy the code from this rendered document after clicking on `</> Code` in the top right corner.\n\n**Please replace the instructions in this template by your own text, explaining what you are doing in each exercise.**\n\nThe following will set-up [`markmyassignment`](https://github.com/MansMeg/markmyassignment) to check your functions at the end of the notebook:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(markmyassignment)){\n    install.packages(\"markmyassignment\")\n    library(markmyassignment)\n}\nassignment_path = paste(\"https://github.com/avehtari/BDA_course_Aalto/\",\n\"blob/master/assignments/tests/assignment4.yml\", sep=\"\")\nset_assignment(assignment_path)\n```\n:::\n\n\n\n\n\n\nThe following installs and loads the `aaltobda` package:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(aaltobda)){\n    install.packages(\"aaltobda\", repos = c(\"https://avehtari.github.io/BDA_course_Aalto/\", getOption(\"repos\")))\n    library(aaltobda)\n}\n```\n:::\n\n\n\n\n\nThe following installs and loads the [`latex2exp` package](https://github.com/stefano-meschiari/latex2exp), which allows us to use LaTeX in plots:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif(!require(latex2exp)){\n    install.packages(\"latex2exp\")\n    library(latex2exp)\n}\n```\n:::\n\n\n\n\n\n\n:::\n::::\n\n\n# Bioassay model\n\n## (a)\n\n\n## (b)\n\n\nLoading the library and the data.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Useful functions: quantile()\n# and mcse_quantile() (from aaltobda)\n\ndata(\"bioassay_posterior\")\n# The 4000 draws are now stored in the variable `bioassay_posterior`.\n# The below displays the first rows of the data:\nhead(bioassay_posterior)\n```\n:::\n\n\n\n\n\n\n\n# Importance sampling\n\n## (c)\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Useful functions: bioassaylp (from aaltobda)\nalpha_test = c(1.896, -3.6,  0.374, 0.964, -3.123, -1.581)\nbeta_test = c(24.76, 20.04, 6.15, 18.65, 8.16, 17.4)\n\n\nlog_importance_weights <- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(-8.95, -23.47, -6.02, -8.13, -16.61, -14.57)\n}\n```\n:::\n\n\n\n\n\n\n\n\n## (d)\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnormalized_importance_weights <- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.045, 0.000, 0.852, 0.103, 0.000, 0.000)\n}\n```\n:::\n\n\n\n\n\n\n\n\n## (e)\n\n\nWrite your answers and code here!\n\n\n\n## (f)\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nS_eff <- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    1.354\n}\n```\n:::\n\n\n\n\n\n\n\n\n## (g)\n\n\n## (h)\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nposterior_mean <- function(alpha, beta) {\n    # Do computation here, and return as below.\n    # This is the correct return value for the test data provided above.\n    c(0.503, 8.275)\n}\n```\n:::\n\n\n\n\n\n\n\n\n:::: {.content-hidden when-format=\"pdf\"}\n::: {.callout-warning collapse=false}\n\n## markmyassignment\n\n\n*This block will only be visible in your HTML output, but will be hidden when rendering to PDF with quarto for the submission.*\n**Make sure that this does not get displayed in the PDF!**\n\n\n\nThe following will check the functions for which `markmyassignment` has been set up:\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmark_my_assignment()\n```\n:::\n\n\n\n\n\n\n:::\n::::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}