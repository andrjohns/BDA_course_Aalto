<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aki Vehtari et al.">

<title>Assignment 7 – Bayesian Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assignment8.html" rel="next">
<link href="./assignment6.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./assignment1.html">Assignments</a></li><li class="breadcrumb-item"><a href="./assignment7.html">Assignment 7</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bayesian Data Analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">General instructions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment_instructions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment instructions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./docker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">How to set up docker</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment7.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Assignment 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 8</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./assignment9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 9</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Templates</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./template1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./template2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./template3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./template4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./template5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./template6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./template7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./template8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 8</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./template9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 9</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#general-information" id="toc-general-information" class="nav-link active" data-scroll-target="#general-information"><span class="header-section-number">1</span> General information</a></li>
  <li><a href="#hierarchical-model-chicken-data-with-stan-6p" id="toc-hierarchical-model-chicken-data-with-stan-6p" class="nav-link" data-scroll-target="#hierarchical-model-chicken-data-with-stan-6p"><span class="header-section-number">2</span> Hierarchical Model: Chicken Data with Stan (6p)</a>
  <ul class="collapse">
  <li><a href="#choosing-a-weakly-informative-prior-by-intuition" id="toc-choosing-a-weakly-informative-prior-by-intuition" class="nav-link" data-scroll-target="#choosing-a-weakly-informative-prior-by-intuition"><span class="header-section-number">2.1</span> Choosing a weakly informative prior by intuition</a></li>
  <li><a href="#choosing-a-weakly-informative-prior-using-external-references" id="toc-choosing-a-weakly-informative-prior-using-external-references" class="nav-link" data-scroll-target="#choosing-a-weakly-informative-prior-using-external-references"><span class="header-section-number">2.2</span> Choosing a weakly informative prior using external references</a></li>
  <li><a href="#non-normal-priors" id="toc-non-normal-priors" class="nav-link" data-scroll-target="#non-normal-priors"><span class="header-section-number">2.3</span> Non-normal priors</a></li>
  <li><a href="#modeling-diet-effects-on-chicken-weight" id="toc-modeling-diet-effects-on-chicken-weight" class="nav-link" data-scroll-target="#modeling-diet-effects-on-chicken-weight"><span class="header-section-number">2.4</span> Modeling diet effects on chicken weight</a></li>
  </ul></li>
  <li><a href="#hierarchical-model-with-brms-3p" id="toc-hierarchical-model-with-brms-3p" class="nav-link" data-scroll-target="#hierarchical-model-with-brms-3p"><span class="header-section-number">3</span> Hierarchical model with BRMS (3p)</a></li>
  <li><a href="#overall-quality-of-the-report" id="toc-overall-quality-of-the-report" class="nav-link" data-scroll-target="#overall-quality-of-the-report"><span class="header-section-number">4</span> Overall quality of the report</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./assignment1.html">Assignments</a></li><li class="breadcrumb-item"><a href="./assignment7.html">Assignment 7</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Assignment 7</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
<p class="subtitle lead">Hierarchical model in Stan</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aki Vehtari et al. </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="general-information" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> General information</h1>
<p><strong>The maximum amount of points from this assignment is 9.</strong></p>
<p>We have prepared a <strong>quarto template specific to this assignment (<a href="template7.html">html</a>, <a href="https://avehtari.github.io/BDA_course_Aalto/assignments/template7.qmd">qmd</a>, <a href="template7.pdf">pdf</a>)</strong> to help you get started.</p>
<div class="aalto">
<p>We recommend you use <a href="https://jupyter.cs.aalto.fi">jupyter.cs.aalto.fi</a> or the <a href="docker.html">docker container</a>.</p>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong>Reading instructions</strong>:</p>
<ul>
<li><a href="../BDA3_notes.html#ch5"><strong>The reading instructions for BDA3 Chapter 5</strong></a>.</li>
</ul>
<p><strong>Grading instructions:</strong></p>
<p>The grading will be done in peergrade. All grading questions and evaluations for this assignment are contained within this document in the collapsible <strong>Rubric</strong> blocks.</p>
<p><strong>Installing and using <code>CmdStanR</code>:</strong></p>
<p>See the <a href="https://avehtari.github.io/BDA_course_Aalto/demos.html">Stan demos</a> on how to use Stan in R (or Python). <a href="https://Aalto%20JupyterHub">Aalto JupyterHub</a> has working R and CmdStanR/RStan environment and is probably the easiest way to use Stan. * To use CmdStanR in <a href="https://Aalto%20JupyterHub">Aalto JupyterHub</a>:<br> <code>library(cmdstanr)</code><br> <code>set_cmdstan_path('/coursedata/cmdstan')</code></p>
<p>The Aalto Ubuntu desktops also have the necessary libraries installed.]{.aalto}</p>
<p>To install Stan on your laptop, run ‘install.packages("cmdstanr", repos = c("https://mc-stan.org/r-packages/", getOption("repos")))’ in R. If you encounter problems, see additional answers in <a href="https://avehtari.github.io/BDA_course_Aalto/FAQ.html"><strong>FAQ</strong></a>. <span class="aalto">If you don’t succeed in short amount of time, it is probably easier to use <a href="https://Aalto%20JupyterHub">Aalto JupyterHub</a>.</span></p>
<p><span class="aalto">If you use <code>Aalto JupyterHub</code>, all necessary packages have been pre-installed.</span> In your laptop, install package <code>cmdstanr</code>. Installation instructions on Linux, Mac and Windows can be found at <a href="https://mc-stan.org/cmdstanr/" class="uri">https://mc-stan.org/cmdstanr/</a>. Additional useful packages are <code>loo</code>, <code>bayesplot</code> and <code>posterior</code> (but you don’t need these in this assignment). For Python users, <code>PyStan</code>, <code>CmdStanPy</code>, and <code>ArviZ</code> packages are useful.</p>
<p>Stan manual can be found at <a href="https://mc-stan.org/users/documentation/" class="uri">https://mc-stan.org/users/documentation/</a>. From this website, you can also find a lot of other useful material about Stan.</p>
<p>If you edit files ending <code>.stan</code> in RStudio, you can click “Check” in the editor toolbar to make syntax check. This can significantly speed-up writing a working Stan model.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Reporting accuracy
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p><strong>For posterior statistics of interest, only report digits that are not completely random based on the Monte Carlo standard error (MCSE).</strong></p>
<p><em>Example:</em> If you estimate <span class="math inline">\(E(\mu) \approx 1.234\)</span> with MCSE(<span class="math inline">\(E(\mu)\)</span>) = 0.01, then the true expectation is likely to be between <span class="math inline">\(1.204\)</span> and <span class="math inline">\(1.264\)</span>, it makes sense to report <span class="math inline">\(E(\mu) \approx 1.2\)</span>.</p>
<p>See Lecture video 4.1, <a href="../BDA3_notes.html#ch10">the chapter notes</a>, and <a href="https://avehtari.github.io/casestudies/Digits/digits.html">a case study</a> for more information.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Further information
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>The recommended tool in this course is R (with the IDE RStudio).</li>
<li>Instead of installing R and RStudio on you own computer, see <a href="https://avehtari.github.io/BDA_course_Aalto/FAQ.html#How_to_use_R_and_RStudio_remotely"><strong>how to use R and RStudio remotely</strong></a>.</li>
<li>If you want to install R and RStudio locally, download <a href="https://posit.co/download/rstudio-desktop/">R and RStudio</a>.</li>
<li>There are tons of tutorials, videos and introductions to R and RStudio online. You can find some initial hints from <a href="https://education.rstudio.com/"><strong>RStudio Education pages</strong></a>.</li>
<li>When working with R, we recommend writing the report using <code>quarto</code> and the provided template. The template includes the formatting instructions and how to include code and figures.</li>
<li>Instead of <code>quarto</code>, you can use other software to make the PDF report, but the the same instructions for formatting should be used.</li>
<li>Report all results in a single, <strong>anonymous</strong> *.pdf -file and submit it in <a href="peergrade.io"><strong>peergrade.io</strong></a>.</li>
<li>The course has its own R package <code>aaltobda</code> with data and functionality to simplify coding. The package is pre-installed in JupyterHub. To install the package on your own system, run the following code (upgrade="never" skips question about updating other packages):</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">install.packages</span>(<span class="st">"aaltobda"</span>, <span class="at">repos =</span> <span class="fu">c</span>(<span class="st">"https://avehtari.r-universe.dev"</span>, <span class="fu">getOption</span>(<span class="st">"repos"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Many of the exercises can be checked automatically using the R package <code>markmyassignment</code> (pre-installed in JupyterHub). Information on how to install and use the package can be found in <a href="https://cran.r-project.org/web/packages/markmyassignment/vignettes/markmyassignment.html">the <code>markmyassignment</code> documentation</a>. There is no need to include <code>markmyassignment</code> results in the report.</li>
<li>Recommended additional self study exercises for each chapter in BDA3 are listed in the course web page. These will help to gain deeper understanding of the topic.</li>
<li>Common questions and answers regarding installation and technical problems can be found in <a href="https://avehtari.github.io/BDA_course_Aalto/FAQ.html">Frequently Asked Questions (FAQ)</a>.</li>
<li>Deadlines for all assignments can be found on the course web page and in Peergrade. You can set email alerts for the deadlines in Peergrade settings.</li>
<li>You are allowed to discuss assignments with your friends, but it is not allowed to copy solutions directly from other students or from internet.</li>
<li>You can copy, e.g., plotting code from the course demos, but really try to solve the actual assignment problems with your own code and explanations.</li>
<li>Do not share your answers publicly.</li>
<li>Do not copy answers from the internet or from previous years. We compare the answers to the answers from previous years and to the answers from other students this year.</li>
<li>Use of AI is allowed on the course, but the most of the work needs to by the student, and you need to report whether you used AI and in which way you used them (See <a href="https://www.aalto.fi/en/services/guidance-for-the-use-of-artificial-intelligence-in-teaching-and-learning-at-aalto-university">points 5 and 6 in Aalto guidelines for use of AI in teaching</a>).</li>
<li>All suspected plagiarism will be reported and investigated. See more about the <a href="https://into.aalto.fi/display/ensaannot/Aalto+University+Code+of+Academic+Integrity+and+Handling+Violations+Thereof"><strong>Aalto University Code of Academic Integrity and Handling Violations Thereof</strong></a>.</li>
<li>Do not submit empty PDFs, almost empty PDFs, copy of the questions, nonsense generated by yourself or AI, as these are just harming the other students as they can’t do peergrading for the empty or nonsense submissions. Violations of this rule will be reported and investigated in the same way was plagiarism.</li>
<li>If you have any suggestions or improvements to the course material, please post in the course chat feedback channel, create an issue, or submit a pull request to the public repository!</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rubric S1: General information - 7.5/100 points
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q1: </strong>
Can you open the PDF and it’s not blank nor nonsense? If the pdf is blank, nonsense, or something like only a copy of the questions, 1) report it as problematic in Peergrade-interface to get another report to review, and 2) send a message to TAs.</li>
<li><strong>Q2: </strong>
Is the report anonymous?</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Setup
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The following loads several needed packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">library</span>(aaltobda)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">library</span>(ggdist) <span class="co"># for stat_dotsinterval</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="fu">library</span>(posterior)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(brms)){</span>
<span id="cb2-9"><a href="#cb2-9"></a>    <span class="fu">install.packages</span>(<span class="st">"brms"</span>)</span>
<span id="cb2-10"><a href="#cb2-10"></a>    <span class="fu">library</span>(brms)</span>
<span id="cb2-11"><a href="#cb2-11"></a>}</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co"># Set more readable themes with bigger font for plotting packages.</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb2-15"><a href="#cb2-15"></a>bayesplot<span class="sc">::</span><span class="fu">bayesplot_theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co"># This registers CmdStan as the backend for compiling cmdstan-chunks.</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="fu">check_cmdstan_toolchain</span>(<span class="at">fix =</span> <span class="cn">TRUE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="fu">register_knitr_engine</span>(<span class="at">override =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="hierarchical-model-chicken-data-with-stan-6p" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Hierarchical Model: Chicken Data with Stan (6p)</h1>
<p><strong>Do not look at the secret dataset until you have defined your priors in section 2.1.</strong></p>
<p>A secret dataset, included in base <code>r</code>, contains weight measurements from 50 chicks from their birth until the age of 21 days. For this task, we are interested in modeling the weight of a chick at the age of 12 days.</p>
<section id="choosing-a-weakly-informative-prior-by-intuition" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="choosing-a-weakly-informative-prior-by-intuition"><span class="header-section-number">2.1</span> Choosing a weakly informative prior by intuition</h2>
<p>We will first guide you through two processes for choosing <em>weakly</em> informative priors which you can use in your projects as well (though, if expert knowledge is present, we encourage to use that though instead). Many definitions of <em>weak</em> exist, but for our purposes, we intend to set priors in this assignment which don’t overwhelm the likelihood contributions to the posterior while still exerting some amount of regularisation.</p>
<p>In the absence of additional information, we will assume that chick weights at 12 days of age (<span class="math inline">\(w\)</span>) follow a normal distribution: <span class="math display">\[
w\sim\mathcal N (\mu,\sigma).
\]</span> Our task will be to define weakly informative priors for the mean <span class="math inline">\(\mu\)</span> given observation model standard deviation, <span class="math inline">\(\sigma\)</span> (a prior distribution for <span class="math inline">\(\sigma\)</span> will be set in after section 2).</p>
<p>Here, <span class="math inline">\(\mu\)</span> represents the population mean chick weight at 12 days and <span class="math inline">\(\sigma\)</span> represents the standard-deviation of the chick weights <span class="math inline">\(w\)</span> around that population mean. For this exercise, we will be specifying a normal prior for <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math display">\[
\mu\sim\mathcal N (\mu_0,\sigma_0).
\]</span></p>
<p><span class="math inline">\(\mu_0\)</span> represents our prior knowledge of what we believe the population weight to be and <span class="math inline">\(\sigma_0\)</span> represents our level of certainty in this belief. To specify a weakly-informative prior for <span class="math inline">\(\mu\)</span> we need to select values of <span class="math inline">\(\mu_0\)</span> and <span class="math inline">\(\sigma_0\)</span> that imply the range of plausible values that <span class="math inline">\(\mu\)</span> could take.</p>
<p>We can do this by our own intuitive prior knowledge (if such intuition exists), or by searching for external references.</p>
<p>Despite the name, weakly informed priors can be quite subjective (<a href="http://www.stat.columbia.edu/~gelman/research/published/entropy-19-00555-v2.pdf">see for more theoretical discussion here</a>), such that some justification is always needed. For the subtasks below, you will not be graded on the accuracy or precision of your numbers, but on your justification of them. The numerical choices you make should make sense and be understandable to an external reviewer of your work (even if they may not agree with your choices).</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
A word of caution on eliciting the priors below
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Please note that in the below, we intend to set a prior on <span class="math inline">\(\mu\)</span> (the <em>mean</em> chick weight), but the intuition we ilicit is based on the weight of <em>individual</em> chicks. We do so to help create intuition about what the mean could be, however, it would be theoretically more accurate to ilicit priors about <em>mean</em> chick weights.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>We have made changes to the assignment text and some of the rubrics to make it clearer.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.a)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Based on your own past experience and estimation skills, what would you guess is a typical weight range of a fully grown chicken in grams? Justify your choice with 1-3 sentences.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Would it make sense if a chicken weighed 1 million grams? 0.005 grams? What about a chicken that weighed more than you? More than a car? Note that is not important to have a very precise or accurate guess here, the key goal is simply to identify the range of plausible (or at least possible) values.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.a)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q3: </strong>
Does the chosen range meet the following common sense criteria?
<ul>
<li>The range is always above <strong>…</strong> and below <strong>…</strong>.</li>
</ul></li>
<li><strong>Q4: </strong>
Is the justification based on some sort of logic, even if you may disagree?</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.b)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Adjust this range for a 12-day old chick and choose a mean <span class="math inline">\(\mu_0\)</span> for the weakly informed prior of the parameter <span class="math inline">\(\mu.\)</span> Justify your adjustment and choice with 1-3 sentences.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.b)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q5: </strong>
The range is always above <strong>…</strong> and below <strong>…</strong>.</li>
<li><strong>Q6: </strong>
Is the justification based on some sort of logic, even if you may disagree?</li>
</ul>
</div>
</div>
</div>
<p>Choosing the prior standard deviation for <span class="math inline">\(\mu\)</span> requires a little more caution; overconfident (i.e.&nbsp;narrow) priors can have a strong effect on your results, whereas less confident priors are more easily overcome with observed data. Given that overconfidence is a common human bias, a good intuition-based standard deviation should focus on eliminating the impossible values, rather than including the most likely values.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.c)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Choose a conservative lower and upper bound for the weight of any 12-day old chick, with the goal to exclude impossible values. Justify your choice with 1-3 sentences.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Depending on your choice of range above for a “typical” chick, this range excluding the impossible values should be wider.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.c)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q7: </strong>
Does the chosen range meet the following common sense criteria?
<ul>
<li>The range is always above <strong>…</strong> and below <strong>…</strong>.</li>
</ul></li>
<li><strong>Q8: </strong>
Is the justification based on some sort of logic, even if you may disagree?</li>
</ul>
</div>
</div>
</div>
<p>A common technique to find a weakly informative prior is to have a standard deviation which is an order of magnitude (a factor of 10) larger than a plausible standard deviation of the data.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.d)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>What do you think is a plausible standard deviation <span class="math inline">\(\sigma_\text{plausible}\)</span> of the weight of 12 days-old chicks, based on your ranges stated above? Under the above recommendation, what standard deviation <span class="math inline">\(\sigma_0\)</span> should you use for your prior for the mean weight <span class="math inline">\(\mu\)</span>?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.d)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q9: </strong>
Do the two standard deviations meet the following common sense criteria?
<ul>
<li>Both values are <strong>…</strong></li>
</ul></li>
<li><strong>Q10: </strong>
Given the choice of mean from above, the interval <span class="math inline">\((\mu_0 - 3\sigma_0, \mu_0 + 3\sigma_0)\)</span> includes <strong>…</strong>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.e)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Write down in mathematical form the final prior for the mean weight <span class="math inline">\(\mu\)</span> you found using this prior definition technique.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.e)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q11: </strong>
Does the final prior exist in mathematical notation?</li>
<li><strong>Q12: </strong>
Does the prior reflect the choices made above (i.e.&nbsp;<span class="math inline">\(\mu_0, \sigma_0\)</span>)?</li>
</ul>
</div>
</div>
</div>
</section>
<section id="choosing-a-weakly-informative-prior-using-external-references" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="choosing-a-weakly-informative-prior-using-external-references"><span class="header-section-number">2.2</span> Choosing a weakly informative prior using external references</h2>
<p>Next, we’ll use external references to pick the weakly informed prior. This technique is more general and doesn’t assume you would have prior knowledge.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.f)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Consult a trustworthy source on the weight range of farm chickens, e.g.&nbsp;books, articles, a farmer friend. If the recommended values are for a fully grown chicken, make a reasonable adjustment for a 12-day old chick. What is the weight range of a 12-day old chicken? Cite your source and justify any adjustments you make to the reference range.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.f)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q13: </strong>
Does the reference range meet the following common sense criteria?
<ul>
<li>The range is always above <strong>…</strong> and below <strong>…</strong>.</li>
</ul></li>
<li><strong>Q14: </strong>
Is there a citation? If an adjustment was made, was it justified by logic, even if you disagree?</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.g)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Based on this reference range, what will you choose for the mean of our weakly informed prior? Justify your choice with 1-3 sentences.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.g)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q15: </strong>
Does the mean value meet the following common sense criteria?
<ul>
<li>The range is always above <strong>…</strong> and below <strong>…</strong>.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<p>Next we choose the standard deviation of the prior. We could use the same technique as before, but we’ll walk you through another common approach. Assume that <span class="math inline">\(99.7\%\)</span> of all 12-day old chicks fall into the reference range you found. Under our assumption of a normal distribution, this range will encompass values between <span class="math inline">\(\mu_0 \pm 3\sigma_0\)</span>.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.h)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Assuming symmetry, use the mean you chose and either the upper or lower bound <span class="math inline">\(b\)</span> of your reference range to solve the correct version of the following equations to find your associated choice of <span class="math inline">\(\sigma_0\)</span>: (show your work)</p>
<ul>
<li>For upper bound <span class="math inline">\(b_u\)</span>: <span class="math inline">\(Pr(\mu_0 + 3\sigma_0 &lt; b_u) \approx 0.997\)</span>, solving for <span class="math inline">\(\sigma_0\)</span>.</li>
<li>For lower bound <span class="math inline">\(b_l\)</span>: <span class="math inline">\(Pr(\mu_0 - 3\sigma_0 &gt; b_l) \approx 0.997\)</span>, solving for <span class="math inline">\(\sigma_0\)</span>.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.h)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q16: </strong>
Does the calculated <span class="math inline">\(\sigma_0\)</span> value meet the following common sense criteria?
<ul>
<li>The value is above <strong>…</strong> and below <strong>…</strong>.</li>
</ul></li>
<li><strong>Q17: </strong>
Did they show their work?</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.i)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Write down in mathematical form the final prior for the mean weight <span class="math inline">\(\mu\)</span> you found using this prior definition technique.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.i)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q18: </strong>
Does the final prior exist in mathematical notation?</li>
<li><strong>Q19: </strong>
Does the prior reflect the choices made above (i.e.&nbsp;<span class="math inline">\(\mu_0, \sigma_0\)</span>)?</li>
</ul>
</div>
</div>
</div>
</section>
<section id="non-normal-priors" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="non-normal-priors"><span class="header-section-number">2.3</span> Non-normal priors</h2>
<p>The previous steps all assumed we could use a prior which is normally distributed, but this may not always be the correct assumption to make.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.j)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Under what mathematical/statistical circumstances would a normal distributed prior not make sense? List at least one circumstance. Are there values that the normal distribution can take on which would not make sense for some types of variables?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Consider the nature of any variable you are trying to define a prior over.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.j)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q20: </strong>
Example cases include variables that <strong>…</strong> or variables that <strong>…</strong></li>
</ul>
</div>
</div>
</div>
</section>
<section id="modeling-diet-effects-on-chicken-weight" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="modeling-diet-effects-on-chicken-weight"><span class="header-section-number">2.4</span> Modeling diet effects on chicken weight</h2>
<p>In addition to chick weights, the data also contains a categorical variable indicating which diet the chick received. In the data file, each column contains the measurements for a single chick at a given point of time.</p>
<p>In addition to the existing diets, we are interested in the quality of another box of feed (the fifth diet), which a farmer happened to find yesterday at a dark corner of his warehouse. To read in the data and select chicks with age of 12 days, and to have a peek at the first 6 rows, just use:</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Data inside, don’t peek before you have set your priors!
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Have you set your priors?
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">data</span>(<span class="st">"ChickWeight"</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>Chick12 <span class="ot">&lt;-</span> ChickWeight <span class="sc">|&gt;</span> <span class="fu">filter</span>(Time <span class="sc">==</span> <span class="dv">12</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="fu">head</span>(Chick12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>In the following analysis, we will model the <strong>weight of a chick at the age of 12 days</strong>. We will use the following three Gaussian models:</p>
<ul>
<li>a separate model, in which each diet is modeled individually</li>
<li>a pooled model, in which all measurements are combined and there is no distinction between diets</li>
<li>a hierarchical model, which has a hierarchical structure as described in <a href="https://users.aalto.fi/~ave/BDA3.pdf">BDA3</a> Section 11.6</li>
</ul>
<p>As in the model described in the book, use the same weight standard deviation <span class="math inline">\(\sigma\)</span> for all the groups in the hierarchical model. In the separate model, however, use separate weight standard deviation <span class="math inline">\(\sigma_d\)</span> for each diet <span class="math inline">\(d\)</span>. You should use weakly informative priors for all your models.</p>
<p>The provided Stan code below is given as an example of a separate model. Note that the author has left a comment expressing uncertainty about their prior choices. This separate model can be summarized mathematically as <span id="eq-separate"><span class="math display">\[
\begin{aligned}
    \mu_{d} &amp;\sim \pi(\mu_d)&amp;&amp;\text{(diet-wise mean weight),}\\
    \sigma_d &amp;\sim \pi(\sigma_d)&amp;&amp;\text{(diet-wise standard deviation of diet-wise chicken weights)},\\
    w_{i,d} &amp;\sim N(\mu_d,\sigma_d)&amp;&amp;\text{(diet-wise chicken weights)}\\
\end{aligned}
\tag{1}\]</span></span></p>
<p>with priors</p>
<p><span id="eq-separate-priors"><span class="math display">\[
\begin{aligned}
    \mu_{d} &amp;\sim N(0,10)&amp;&amp;\text{(adjust this) and}\\
    \sigma_d &amp;\sim\mathrm{exponential}(.02)&amp;&amp;\text{(you can keep this).}
\end{aligned}
\tag{2}\]</span></span></p>
<p>For the separate and the pooled models, use one of the weakly informative priors you have derived in 2.1) or 2.2) for the diet-wise mean weights <span class="math display">\[\mu_d\sim \pi(\mu_d)=N(\mu_0,\sigma_0).\]</span> For the hierarchical model, remember that the parameters in the priors for the diet-wise mean weights itself have to be parameters with their own prior distributions, in our case <span class="math display">\[
\begin{aligned}
\mu_d &amp;\sim N(\mu,\tau)&amp;&amp;\text{(diet-wise mean weights)},\\
\mu &amp;\sim \pi(\mu)&amp;&amp;\text{(mean of prior for diet-wise mean weights) and}\\
\tau &amp;\sim \pi(\tau)&amp;&amp;\text{(standard deviation of prior for diet-wise mean weights).}
\end{aligned}
\]</span></p>
<p>Use the prior you have used for the diet-wise mean weights <span class="math inline">\(\mu_d\)</span> in the separate and pooled models for the prior on the mean of the prior for the diet-wise mean weights <span class="math display">\[\mu \sim \pi(\mu) = N(\mu_0,\sigma_0)\]</span> in the hierarchical model and use <span class="math display">\[\tau \sim \pi(\tau) = \mathrm{exponential}(.02)\]</span> for the prior on the standard deviation of the prior for the diet-wise mean weights.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource stan number-lines code-with-copy"><code class="sourceCode stan"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">data</span> {</span>
<span id="cb4-2"><a href="#cb4-2"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; N_observations;</span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="dt">int</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt; N_diets;</span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="dt">array</span>[N_observations] <span class="dt">int</span> diet_idx; <span class="co">// Pair observations to their diets.</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="dt">vector</span>[N_observations] weight;</span>
<span id="cb4-6"><a href="#cb4-6"></a>}</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="kw">parameters</span> {</span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="co">// Average weight of chicks with a given diet.</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="dt">vector</span>[N_diets] mean_diet;</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="co">// Standard deviation of weights observed among chicks sharing a diet.</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="dt">vector</span>&lt;<span class="kw">lower</span>=<span class="dv">0</span>&gt;[N_diets] sd_diet;</span>
<span id="cb4-14"><a href="#cb4-14"></a>}</span>
<span id="cb4-15"><a href="#cb4-15"></a></span>
<span id="cb4-16"><a href="#cb4-16"></a><span class="kw">model</span> {</span>
<span id="cb4-17"><a href="#cb4-17"></a>  <span class="co">// Priors</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>  <span class="co">// These look bad. I need to think about these again.</span></span>
<span id="cb4-19"><a href="#cb4-19"></a></span>
<span id="cb4-20"><a href="#cb4-20"></a>  <span class="cf">for</span> (diet <span class="cf">in</span> <span class="dv">1</span>:N_diets) {</span>
<span id="cb4-21"><a href="#cb4-21"></a>    mean_diet[diet] ~ normal(<span class="dv">0</span>, <span class="dv">10</span>);</span>
<span id="cb4-22"><a href="#cb4-22"></a>    sd_diet[diet] ~ exponential(.<span class="dv">02</span>);</span>
<span id="cb4-23"><a href="#cb4-23"></a>  }</span>
<span id="cb4-24"><a href="#cb4-24"></a></span>
<span id="cb4-25"><a href="#cb4-25"></a>  <span class="co">// Likelihood</span></span>
<span id="cb4-26"><a href="#cb4-26"></a>  <span class="cf">for</span> (obs <span class="cf">in</span> <span class="dv">1</span>:N_observations) {</span>
<span id="cb4-27"><a href="#cb4-27"></a>    weight[obs] ~ normal(mean_diet[diet_idx[obs]], sd_diet[diet_idx[obs]]);</span>
<span id="cb4-28"><a href="#cb4-28"></a>  }</span>
<span id="cb4-29"><a href="#cb4-29"></a></span>
<span id="cb4-30"><a href="#cb4-30"></a>  <span class="co">// Best practice would be to write the likelihood without the for loop as:</span></span>
<span id="cb4-31"><a href="#cb4-31"></a>  <span class="co">// weight ~ normal(mean_diet[diet_idx], sd_diet[diet_idx]);</span></span>
<span id="cb4-32"><a href="#cb4-32"></a>}</span>
<span id="cb4-33"><a href="#cb4-33"></a></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="kw">generated quantities</span> {</span>
<span id="cb4-35"><a href="#cb4-35"></a>  <span class="dt">real</span> weight_pred;</span>
<span id="cb4-36"><a href="#cb4-36"></a>  <span class="dt">real</span> mean_five;</span>
<span id="cb4-37"><a href="#cb4-37"></a>  <span class="co">// The below is just there to make the plotting in the template work with the "wrong model". </span></span>
<span id="cb4-38"><a href="#cb4-38"></a>  <span class="dt">real</span> sd_diets = sd_diet[<span class="dv">4</span>];</span>
<span id="cb4-39"><a href="#cb4-39"></a></span>
<span id="cb4-40"><a href="#cb4-40"></a>  <span class="co">// Sample from the (posterior) predictive distribution of the fourth diet.</span></span>
<span id="cb4-41"><a href="#cb4-41"></a>  weight_pred = normal_rng(mean_diet[<span class="dv">4</span>], sd_diet[<span class="dv">4</span>]);</span>
<span id="cb4-42"><a href="#cb4-42"></a></span>
<span id="cb4-43"><a href="#cb4-43"></a>  <span class="co">// Construct samples of the mean of the fifth diet.</span></span>
<span id="cb4-44"><a href="#cb4-44"></a>  <span class="co">// We only have the prior...</span></span>
<span id="cb4-45"><a href="#cb4-45"></a>  mean_five = normal_rng(<span class="dv">0</span>, <span class="dv">10</span>);</span>
<span id="cb4-46"><a href="#cb4-46"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.k)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Describe the models with mathematical notation (as is done for the separate model above). Also describe in words the difference between the model and the other models.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.k)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q21: </strong>
Are the models described using mathematical notation and the difference to other models described in words?
<ul>
<li>No equations and no description</li>
<li>Description but no equations</li>
<li>Equations but no description</li>
<li>Equations and description</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.l)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Implement the models in Stan and include the code in the report. Use weakly informative priors for all of your models.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>When sampling from the posterior of the hierarchical model, you will very likely get a warning about divergent transitions. This tells you that the sampler is having difficulties in sampling the joint posterior and this may lead to biased inference. We will return to this in the next task.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.l)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q22: </strong>
Is there a related Stan implementation?
<ul>
<li>No Stan model implemented</li>
<li>Stan model implemented, but it seems clearly wrong or broken</li>
<li>Seemingly valid Stan model implemented</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.m)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Use the provided code in the template to plot the <strong>posterior distribution of the mean of the weight measurements of the fourth diet</strong> and comment on the possible differences you observe between the models.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-39-contents" aria-controls="callout-39" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.m)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-39" class="callout-39-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q23: </strong>
Is there a comparison plotted for the posteriors of the mean of diet 4? Does it look something like the model solution plot?
<ul>
<li>No comparison plotted</li>
<li>Comparison plotted but it clearly differs from the example</li>
<li>Comparison plotted and it approximately matches the example</li>
</ul></li>
<li><strong>Q24: </strong>
Separate model: Is the result for the separate model discussed?
<ul>
<li>The result is not discussed.</li>
<li>There is some discussion, but it is not mentioned that <strong>…</strong>.</li>
<li>The result is discussed and the separate model is recognised as <strong>…</strong>.</li>
</ul></li>
<li><strong>Q25: </strong>
Pooled model: Is the result for the pooled model discussed?
<ul>
<li>The result is not discussed.</li>
<li>There is some discussion, but it is not mentioned that <strong>…</strong>.</li>
<li>The result is discussed and the pooled model is recognised as <strong>…</strong>.</li>
</ul></li>
<li><strong>Q26: </strong>
Hierarchical model: Is the result for the hierarchical model discussed?
<ul>
<li>The result is not discussed.</li>
<li>There is some discussion, but it is not mentioned that <strong>…</strong>.</li>
<li>The result is discussed and the hierarchical model is recognised as <strong>…</strong>.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-40-contents" aria-controls="callout-40" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.n)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-40" class="callout-40-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Use the provided code in the template to plot the <strong>predictive distribution for another weight measurement from a chick having the fourth diet</strong> and comment on the possible differences you observe between the models.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-41-contents" aria-controls="callout-41" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.n)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-41" class="callout-41-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q27: </strong>
Is there a comparison plotted for the predictive distributions of the weight of a chick with diet 4? Does it look something like the model solution plot?
<ul>
<li>No comparison plotted</li>
<li>Comparison plotted but it clearly differs from the example</li>
<li>Comparison plotted and it approximately matches the example</li>
</ul></li>
<li><strong>Q28: </strong>
Separate model: Is the result for the separate model discussed?
<ul>
<li>The result is not discussed.</li>
<li>There is some discussion, but it is not mentioned that <strong>…</strong>.</li>
<li>The result is discussed and the separate model is recognised as <strong>…</strong>.</li>
</ul></li>
<li><strong>Q29: </strong>
Pooled model: Is the result for the pooled model discussed?
<ul>
<li>The result is not discussed.</li>
<li>There is some discussion, but it is not mentioned that <strong>…</strong>.</li>
<li>The result is discussed and the pooled model is recognised as <strong>…</strong>.</li>
</ul></li>
<li><strong>Q30: </strong>
Hierarchical model: Is the result for the hierarchical model discussed?
<ul>
<li>The result is not discussed.</li>
<li>There is some discussion, but it is not mentioned that <strong>…</strong>.</li>
<li>The result is discussed and the hierarchical model is recognised as <strong>…</strong>.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-42-contents" aria-controls="callout-42" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.o)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-42" class="callout-42-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Use the provided code in the template to plot the <strong>posterior distribution of the mean of the weight measurements of a new fifth diet</strong> and comment on the possible differences you observe between the models.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-43-contents" aria-controls="callout-43" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.o)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-43" class="callout-43-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q31: </strong>
Is there a comparison plotted for the posterior distributions of the mean weight with a new diet? Does it look something like the model solution plot?
<ul>
<li>No comparison plotted</li>
<li>Comparison plotted but it clearly differs from the example</li>
<li>Comparison plotted and it approximately matches the example</li>
</ul></li>
<li><strong>Q32: </strong>
Separate model: Is the result for the separate model discussed?
<ul>
<li>The result is not discussed.</li>
<li>There is some discussion, but it is not mentioned that <strong>…</strong>.</li>
<li>The result is discussed and the separate model is recognised as <strong>…</strong>.</li>
<li>In addition to the previous option, it is recognised that <strong>…</strong>.</li>
</ul></li>
<li><strong>Q33: </strong>
Pooled model: Is the result for the pooled model discussed?
<ul>
<li>The result is not discussed.</li>
<li>There is some discussion, but it is not mentioned that <strong>…</strong>.</li>
<li>The result is discussed and the pooled model is recognised as <strong>…</strong>.</li>
<li>In addition to the previous option, it is mentioned that <strong>…</strong>.</li>
</ul></li>
<li><strong>Q34: </strong>
Hierarchical model: Is the result for the hierarchical model discussed?
<ul>
<li>The result is not discussed.</li>
<li>There is some discussion, but it is not mentioned that <strong>…</strong>.</li>
<li>The result is discussed and the hierarchical model is recognised as <strong>…</strong>.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 2.p)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>For each model, report the <strong>posterior expectation for the mean weight of diet 4 with a 90% credible interval</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-45-contents" aria-controls="callout-45" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-45" class="callout-45-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>See the example Stan codes in the demo <a href="http://avehtari.github.io/BDA_R_demos/demos_rstan/cmdstanr_demo.html#8_Comparison_of_(k)_groups_with_hierarchical_models">Bayesian data analysis - CmdStanR demos: Comparison of <span class="math inline">\(k\)</span> groups with hierarchical models</a> for the comparison of <span class="math inline">\(k\)</span> groups with and without the hierarchical structure.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-46-contents" aria-controls="callout-46" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 2.p)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-46" class="callout-46-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q35: </strong>
For the separate model, is the posterior 90% credible interval for the mean of the fourth diet close to: <strong>…</strong> (small/medium deviation is fine).
<ul>
<li>No or incorrect answer</li>
<li>Answer is only partially correct</li>
<li>Answers look correct</li>
</ul></li>
<li><strong>Q36: </strong>
For the pooled model, is the posterior 90% credible interval for the mean of the fourth diet close to: <strong>…</strong> (small/medium deviation is fine).
<ul>
<li>No answer</li>
<li>Answer is only partially correct</li>
<li>Answer looks correct</li>
</ul></li>
<li><strong>Q37: </strong>
For the hierarchical model, is the posterior 90% credible interval for the mean of the fourth diet close to: <strong>…</strong> (small/medium deviation is fine).
<ul>
<li>No answer</li>
<li>Answer is only partially correct.</li>
<li>Answers look correct.</li>
</ul></li>
</ul>
</div>
</div>
</div>
</section>
</section>
<section id="hierarchical-model-with-brms-3p" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Hierarchical model with BRMS (3p)</h1>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>We have made changes to the assignment text and some of the rubrics to make it clearer.</p>
</div>
</div>
<p>The goal of this task is to discuss an alternative parameterisation of hierarchical models and introduce the <code>brms</code>-package.</p>
<p><a href="https://paul-buerkner.github.io/brms/"><code>brms</code></a> is a high-level interface for Stan providing tools to create a wide range of Bayesian models, including hierarchical ones. In the previous section, you might have noted that with the hierarchical implementation of the model there may be divergent transitions during the sampling from the posterior. This is related to <a href="https://mc-stan.org/docs/stan-users-guide/reparameterisation.html">Neal’s funnel</a>, where the sampling algorithm would need to change the step size in order to effectively sample the posterior. One trick to improve sampling is to use an alternative parameterisation for the model. This parameterisation is called the non-centered parameterisation (<a href="#eq-non-centered" class="quarto-xref">Equation&nbsp;3</a>) and often it can help with the divergent transitions.</p>
<p>In short, we sample parameters from a distribution with a potentially easier geometry for the sampler to explore efficiently and then transform those values to the joint distribution of interest.</p>
<p>The noncentered parameterisation for the hierarchical model using the diet-wise helper parameter <span class="math inline">\(z_d\)</span> becomes</p>
<p><span id="eq-non-centered"><span class="math display">\[
\begin{aligned}
z_d &amp;\sim \operatorname{normal}(0, 1)&amp;&amp;\text{(diet-wise helper parameter)},\\
\mu_d &amp;= \mu + z_d \tau&amp;&amp;\text{(diet-wise mean weight)},\\
\mu &amp;\sim \pi(\mu)&amp;&amp;\text{(mean of prior for diet-wise mean weights),}\\
\tau &amp;\sim \pi(\tau)&amp;&amp;\text{(standard deviation of prior for diet-wise mean weights),}\\
\sigma &amp;\sim \pi(\sigma)&amp;&amp;\text{(standard deviation of diet-wise chicken weights) and},\\
w_{i, d} &amp;\sim \operatorname{normal}(\mu_d, \sigma)&amp;&amp;\text{(chicken weights)}.\\
\end{aligned}
\tag{3}\]</span></span></p>
<p>The hierarchical models made with <code>brms</code> use this non-centered parameterisation. Your tasks are the following:</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-48-contents" aria-controls="callout-48" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 3.a)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-48" class="callout-48-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Use the function in the template to make a scatter plot of the posterior draws given the hierarchical model of the population level standard deviation parameter <span class="math inline">\(\tau\)</span> and the mean parameter of the fourth diet, <span class="math inline">\(\mu_4\)</span>. The possible divergent transitions are highlighted in red. In the report show the plot and comment if there are any divergent transitions.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-49-contents" aria-controls="callout-49" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 3.a)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-49" class="callout-49-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q38: </strong>
Is there a scatter plot of <span class="math inline">\(\sigma_0\)</span> and <span class="math inline">\(\mu_4\)</span> and some comments provided in the report?
<ul>
<li>No scatter plot or comments</li>
<li>The scatter plot is included, and divergent transitions are visible, but not commented on.</li>
<li>The scatter plot and comments on the divergences are included.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<p>To sample from the posterior given the same model using <code>brms</code>, in the template set the weakly informative priors for the hierarchical model you used in the previous task. <code>brms</code> has an internal convention to name model parameters and the parameter names from <a href="#eq-non-centered" class="quarto-xref">Equation&nbsp;3</a> map into <code>brms</code> names with the following logic:</p>
<ul>
<li><span class="math inline">\(\mu\)</span> corresponds to <code>class="Intercept"</code></li>
<li><span class="math inline">\(\tau\)</span> corresponds to <code>class="sd"</code>,</li>
<li><span class="math inline">\(\sigma\)</span> corresponds to <code>class="sigma"</code>.</li>
</ul>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-50-contents" aria-controls="callout-50" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 3.b)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-50" class="callout-50-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Replace <code>normal(0,10)</code> in the <code>brm</code> call in the template with your prior for the population mean <span class="math display">\[\mu \sim \pi(\mu) = N(\mu_0,\sigma_0)\]</span> you have derived in 2). Then, run the code chunk to sample from the posterior of the hierarchical model using <code>brms</code>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-51-contents" aria-controls="callout-51" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 3.b)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-51" class="callout-51-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q39: </strong>
Is the <code>brms</code> code shown and do the priors agree with the priors specified above?</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-52-contents" aria-controls="callout-52" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 3.c)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-52" class="callout-52-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Report the <strong>posterior expectation for the mean weight of diet 4 <span class="math inline">\(\mu_4\)</span> with a 90% credible interval</strong>, using the code block in the template. How does it compare with your results from the first task?</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-53-contents" aria-controls="callout-53" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 3.c)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-53" class="callout-53-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q40: </strong>
Given the <code>brms</code> model, is the posterior 90% credible interval for the mean of the fourth diet close to: <strong>…</strong>(small/medium deviation is fine).
<ul>
<li>No answer</li>
<li>Answer is only partially correct.</li>
<li>Answers look correct.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-54-contents" aria-controls="callout-54" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 3.d)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-54" class="callout-54-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>Use the code in the template to make a <strong>scatter plot of the group standard deviation parameter <span class="math inline">\(\tau\)</span> and group specific mean parameter</strong>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-55-contents" aria-controls="callout-55" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 3.d)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-55" class="callout-55-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q41: </strong>
Is there a scatter plot of <span class="math inline">\(\tau\)</span> and <span class="math inline">\(\mu_4\)</span> and some comments provided in the report?
<ul>
<li>No scatter plot or comments</li>
<li>The scatter plot is included, and divergent transitions are visible, but not commented on.</li>
<li>The scatter plot and comments on the divergences are included.</li>
</ul></li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-56-contents" aria-controls="callout-56" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subtask 3.e)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-56" class="callout-56-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<p>In your report, address the following questions based on the plots you made for both parameterisations:</p>
<ul>
<li>Which of the parameterisations resulted in fewer divergent transitions?</li>
<li>Comment for both parameterisations: for which kind of values of <span class="math inline">\(\tau\)</span>, do the divergent transitions occur (if there are any)? It also might be that no clear pattern can be seen.</li>
<li>Does centered parameterisation have problems sampling from some specific region of the parameter space compared to the non-centered parameterisation.</li>
</ul>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-57-contents" aria-controls="callout-57" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Subrubric 3.e)
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-57" class="callout-57-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q42: </strong>
Has it been discussed which parameterisation resulted in fewer divergent transitions?</li>
<li><strong>Q43: </strong>
Has it been discussed for which values of <span class="math inline">\(\tau\)</span> the divergences occurred?</li>
<li><strong>Q44: </strong>
Has it been discussed whether/where the centered parameterisation has problems sampling?</li>
</ul>
</div>
</div>
</div>
</section>
<section id="overall-quality-of-the-report" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Overall quality of the report</h1>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-58-contents" aria-controls="callout-58" aria-expanded="true" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Rubric S4: Overall quality of the report - 7.5/100 points
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-58" class="callout-58-contents callout-collapse collapse show">
<div class="callout-body-container callout-body">
<ul>
<li><strong>Q45: </strong>
Does the report include comment on whether AI was used, and if AI was used, explanation on how it was used?
<ul>
<li>No</li>
<li>Yes</li>
</ul></li>
<li><strong>Q46: </strong>
Does the report follow the formatting instructions?
<ul>
<li>Not at all</li>
<li>Little</li>
<li>Mostly</li>
<li>Yes</li>
</ul></li>
<li><strong>Q47: </strong>
In case the report doesn’t fully follow the general and formatting instructions, specify the instructions that have not been followed. If applicable, specify the page of the report, where this difference is visible. This will help the other student to improve their reports so that they are easier to read and review. If applicable, specify the page of the report, where this difference in formatting is visible.</li>
<li><strong>Q48: </strong>
Please also provide feedback on the presentation (e.g.&nbsp;text, layout, flow of the responses, figures, figure captions). Part of the course is practicing making data analysis reports. By providing feedback on the report presentation, other students can learn what they can improve or what they already did well. You should be able to provide constructive or positive feedback for all non-empty and non-nonsense reports. If you think the report is perfect, and you can’t come up with any suggestions how to improve, you can provide feedback on what you liked and why you think some part of the report is better than yours.</li>
</ul>
</div>
</div>
</div>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./assignment6.html" class="pagination-link" aria-label="Assignment 6">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Assignment 6</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./assignment8.html" class="pagination-link" aria-label="Assignment 8">
        <span class="nav-page-text">Assignment 8</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb5" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">---</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="an">title:</span><span class="co"> "Assignment 7"</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="an">subtitle:</span><span class="co"> "Hierarchical model in Stan"</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="an">author:</span><span class="co"> "Aki Vehtari et al."</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">  html:</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">    toc: true</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">    code-tools: true</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">    code-line-numbers: true  </span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">    number-sections: true</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">    mainfont: Georgia, serif</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">    page-layout: article</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="an">editor:</span><span class="co"> source</span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="an">filters:</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">  - includes/assignments.lua </span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">  - includes/include-code-files.lua </span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">---</span></span>
<span id="cb5-18"><a href="#cb5-18"></a></span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="fu"># General information</span></span>
<span id="cb5-22"><a href="#cb5-22"></a></span>
<span id="cb5-23"><a href="#cb5-23"></a>**The maximum amount of points from this assignment is 9.**</span>
<span id="cb5-24"><a href="#cb5-24"></a></span>
<span id="cb5-25"><a href="#cb5-25"></a>We have prepared a **quarto template specific to this assignment ([html](template7.html), [qmd](https://avehtari.github.io/BDA_course_Aalto/assignments/template7.qmd), [pdf](template7.pdf))** to help you get started. </span>
<span id="cb5-26"><a href="#cb5-26"></a></span>
<span id="cb5-27"><a href="#cb5-27"></a></span>
<span id="cb5-28"><a href="#cb5-28"></a>:::{.aalto}</span>
<span id="cb5-29"><a href="#cb5-29"></a>We recommend you use <span class="co">[</span><span class="ot">jupyter.cs.aalto.fi</span><span class="co">](https://jupyter.cs.aalto.fi)</span> or the <span class="co">[</span><span class="ot">docker container</span><span class="co">](docker.html)</span>.</span>
<span id="cb5-30"><a href="#cb5-30"></a>:::</span>
<span id="cb5-31"><a href="#cb5-31"></a></span>
<span id="cb5-32"><a href="#cb5-32"></a>:::{.hint}             </span>
<span id="cb5-33"><a href="#cb5-33"></a>**Reading instructions**:</span>
<span id="cb5-34"><a href="#cb5-34"></a></span>
<span id="cb5-35"><a href="#cb5-35"></a><span class="ss">- </span><span class="co">[</span><span class="ot">**The reading instructions for BDA3 Chapter 5**</span><span class="co">](../BDA3_notes.html#ch5)</span>.</span>
<span id="cb5-36"><a href="#cb5-36"></a></span>
<span id="cb5-37"><a href="#cb5-37"></a>{{&lt; include includes/_grading_instructions.md &gt;}}</span>
<span id="cb5-38"><a href="#cb5-38"></a></span>
<span id="cb5-39"><a href="#cb5-39"></a>{{&lt; include includes/_cmdstanr.md &gt;}}</span>
<span id="cb5-40"><a href="#cb5-40"></a>:::</span>
<span id="cb5-41"><a href="#cb5-41"></a></span>
<span id="cb5-42"><a href="#cb5-42"></a>{{&lt; include includes/_reporting_accuracy.md &gt;}}</span>
<span id="cb5-43"><a href="#cb5-43"></a></span>
<span id="cb5-44"><a href="#cb5-44"></a>{{&lt; include includes/_general_info.md &gt;}}</span>
<span id="cb5-45"><a href="#cb5-45"></a></span>
<span id="cb5-46"><a href="#cb5-46"></a></span>
<span id="cb5-47"><a href="#cb5-47"></a></span>
<span id="cb5-48"><a href="#cb5-48"></a>:::: {.content-hidden when-format="pdf"}</span>
<span id="cb5-49"><a href="#cb5-49"></a>::: {.callout-tip collapse=true}</span>
<span id="cb5-50"><a href="#cb5-50"></a> </span>
<span id="cb5-51"><a href="#cb5-51"></a><span class="fu">## Setup </span></span>
<span id="cb5-52"><a href="#cb5-52"></a>The following loads several needed packages:</span>
<span id="cb5-53"><a href="#cb5-53"></a></span>
<span id="cb5-56"><a href="#cb5-56"></a><span class="in">```{r}</span></span>
<span id="cb5-57"><a href="#cb5-57"></a><span class="co">#| label: imports</span></span>
<span id="cb5-58"><a href="#cb5-58"></a></span>
<span id="cb5-59"><a href="#cb5-59"></a><span class="fu">library</span>(aaltobda)</span>
<span id="cb5-60"><a href="#cb5-60"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb5-61"><a href="#cb5-61"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb5-62"><a href="#cb5-62"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-63"><a href="#cb5-63"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-64"><a href="#cb5-64"></a><span class="fu">library</span>(ggdist) <span class="co"># for stat_dotsinterval</span></span>
<span id="cb5-65"><a href="#cb5-65"></a><span class="fu">library</span>(posterior)</span>
<span id="cb5-66"><a href="#cb5-66"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(brms)){</span>
<span id="cb5-67"><a href="#cb5-67"></a>    <span class="fu">install.packages</span>(<span class="st">"brms"</span>)</span>
<span id="cb5-68"><a href="#cb5-68"></a>    <span class="fu">library</span>(brms)</span>
<span id="cb5-69"><a href="#cb5-69"></a>}</span>
<span id="cb5-70"><a href="#cb5-70"></a></span>
<span id="cb5-71"><a href="#cb5-71"></a><span class="co"># Set more readable themes with bigger font for plotting packages.</span></span>
<span id="cb5-72"><a href="#cb5-72"></a>ggplot2<span class="sc">::</span><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb5-73"><a href="#cb5-73"></a>bayesplot<span class="sc">::</span><span class="fu">bayesplot_theme_set</span>(<span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>))</span>
<span id="cb5-74"><a href="#cb5-74"></a></span>
<span id="cb5-75"><a href="#cb5-75"></a><span class="co"># This registers CmdStan as the backend for compiling cmdstan-chunks.</span></span>
<span id="cb5-76"><a href="#cb5-76"></a><span class="fu">check_cmdstan_toolchain</span>(<span class="at">fix =</span> <span class="cn">TRUE</span>, <span class="at">quiet =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-77"><a href="#cb5-77"></a><span class="fu">register_knitr_engine</span>(<span class="at">override =</span> <span class="cn">FALSE</span>)</span>
<span id="cb5-78"><a href="#cb5-78"></a><span class="in">```</span></span>
<span id="cb5-79"><a href="#cb5-79"></a></span>
<span id="cb5-80"><a href="#cb5-80"></a>:::</span>
<span id="cb5-81"><a href="#cb5-81"></a>::::</span>
<span id="cb5-82"><a href="#cb5-82"></a></span>
<span id="cb5-83"><a href="#cb5-83"></a></span>
<span id="cb5-84"><a href="#cb5-84"></a><span class="fu"># Hierarchical Model: Chicken Data with Stan (6p)</span></span>
<span id="cb5-85"><a href="#cb5-85"></a></span>
<span id="cb5-86"><a href="#cb5-86"></a>**Do not look at the secret dataset until you have defined your priors in section 2.1.**</span>
<span id="cb5-87"><a href="#cb5-87"></a></span>
<span id="cb5-88"><a href="#cb5-88"></a>A secret dataset, included in base <span class="in">`r`</span>, contains weight measurements from 50 chicks from their birth until the age of 21 days. For this task, we are interested in modeling the weight of a chick at the age of 12 days.</span>
<span id="cb5-89"><a href="#cb5-89"></a></span>
<span id="cb5-90"><a href="#cb5-90"></a><span class="fu">## Choosing a weakly informative prior by intuition</span></span>
<span id="cb5-91"><a href="#cb5-91"></a></span>
<span id="cb5-92"><a href="#cb5-92"></a>We will first guide you through two processes for choosing *weakly* informative priors which you can use in your projects as well (though, if expert knowledge is present, we encourage to use that though instead). Many definitions of *weak* exist, but for our purposes, we intend to set priors in this assignment which don't overwhelm the likelihood contributions to the posterior while still exerting some amount of regularisation.</span>
<span id="cb5-93"><a href="#cb5-93"></a></span>
<span id="cb5-94"><a href="#cb5-94"></a>In the absence of additional information, we will assume that chick weights at 12 days of age ($w$) follow a normal distribution:</span>
<span id="cb5-95"><a href="#cb5-95"></a>$$</span>
<span id="cb5-96"><a href="#cb5-96"></a>w\sim\mathcal N (\mu,\sigma).</span>
<span id="cb5-97"><a href="#cb5-97"></a>$$</span>
<span id="cb5-98"><a href="#cb5-98"></a>Our task will be to define weakly informative priors for the mean $\mu$ given observation model standard deviation, $\sigma$ (a prior distribution for $\sigma$ will be set in after section 2).</span>
<span id="cb5-99"><a href="#cb5-99"></a></span>
<span id="cb5-100"><a href="#cb5-100"></a>Here, $\mu$ represents the population mean chick weight at 12 days and $\sigma$ represents the standard-deviation of the chick weights $w$ around that population mean. For this exercise, we will be specifying a normal prior for $\mu$:</span>
<span id="cb5-101"><a href="#cb5-101"></a></span>
<span id="cb5-102"><a href="#cb5-102"></a>$$</span>
<span id="cb5-103"><a href="#cb5-103"></a>\mu\sim\mathcal N (\mu_0,\sigma_0).</span>
<span id="cb5-104"><a href="#cb5-104"></a>$$</span>
<span id="cb5-105"><a href="#cb5-105"></a></span>
<span id="cb5-106"><a href="#cb5-106"></a>$\mu_0$ represents our prior knowledge of what we believe the population weight to be and $\sigma_0$ represents our level of certainty in this belief. To specify a weakly-informative prior for $\mu$ we need to select values of $\mu_0$ and $\sigma_0$ that imply the range of plausible values that $\mu$ could take.</span>
<span id="cb5-107"><a href="#cb5-107"></a></span>
<span id="cb5-108"><a href="#cb5-108"></a>We can do this by our own intuitive prior knowledge (if such intuition exists), or by searching for external references.</span>
<span id="cb5-109"><a href="#cb5-109"></a></span>
<span id="cb5-110"><a href="#cb5-110"></a>Despite the name, weakly informed priors can be quite subjective (<span class="co">[</span><span class="ot">see for more theoretical discussion here</span><span class="co">](http://www.stat.columbia.edu/~gelman/research/published/entropy-19-00555-v2.pdf)</span>), such that some justification is always needed. For the subtasks below, you will not be graded on the accuracy or precision of your numbers, but on your justification of them. The numerical choices you make should make sense and be understandable to an external reviewer of your work (even if they may not agree with your choices).</span>
<span id="cb5-111"><a href="#cb5-111"></a></span>
<span id="cb5-112"><a href="#cb5-112"></a></span>
<span id="cb5-113"><a href="#cb5-113"></a>::: {.callout-caution collapse="false"}</span>
<span id="cb5-114"><a href="#cb5-114"></a><span class="fu">## A word of caution on eliciting the priors below</span></span>
<span id="cb5-115"><a href="#cb5-115"></a>Please note that in the below, we intend to set a prior on $\mu$ (the *mean* chick weight), but the intuition we ilicit is based on the weight of *individual* chicks. We do so to help create intuition about what the mean could be, however, it would be theoretically more accurate to ilicit priors about *mean* chick weights. </span>
<span id="cb5-116"><a href="#cb5-116"></a>:::</span>
<span id="cb5-117"><a href="#cb5-117"></a></span>
<span id="cb5-118"><a href="#cb5-118"></a>:::{.callout-important}</span>
<span id="cb5-119"><a href="#cb5-119"></a></span>
<span id="cb5-120"><a href="#cb5-120"></a>We have made changes to the assignment text and some of the rubrics to make it clearer.</span>
<span id="cb5-121"><a href="#cb5-121"></a></span>
<span id="cb5-122"><a href="#cb5-122"></a>:::</span>
<span id="cb5-123"><a href="#cb5-123"></a></span>
<span id="cb5-124"><a href="#cb5-124"></a></span>
<span id="cb5-125"><a href="#cb5-125"></a>:::{.subtask letter=a}</span>
<span id="cb5-126"><a href="#cb5-126"></a>Based on your own past experience and estimation skills, what would you guess is a typical weight range of a fully grown chicken in grams? Justify your choice with 1-3 sentences.</span>
<span id="cb5-127"><a href="#cb5-127"></a>:::</span>
<span id="cb5-128"><a href="#cb5-128"></a></span>
<span id="cb5-129"><a href="#cb5-129"></a>:::{.hint}</span>
<span id="cb5-130"><a href="#cb5-130"></a>Would it make sense if a chicken weighed 1 million grams? 0.005 grams? What about a chicken that weighed more than you? More than a car? Note that is not important to have a very precise or accurate guess here, the key goal is simply to identify the range of plausible (or at least possible) values.</span>
<span id="cb5-131"><a href="#cb5-131"></a>:::</span>
<span id="cb5-132"><a href="#cb5-132"></a></span>
<span id="cb5-133"><a href="#cb5-133"></a>::::{.subrubric}</span>
<span id="cb5-134"><a href="#cb5-134"></a><span class="fu">### Fully grown chicken weight range by intuition</span></span>
<span id="cb5-135"><a href="#cb5-135"></a></span>
<span id="cb5-136"><a href="#cb5-136"></a><span class="ss">* </span>Does the chosen range meet the following common sense criteria?</span>
<span id="cb5-137"><a href="#cb5-137"></a><span class="ss">  * </span>The range is always above **...** and below **...**.</span>
<span id="cb5-138"><a href="#cb5-138"></a><span class="ss">* </span>Is the justification based on some sort of logic, even if you may disagree?</span>
<span id="cb5-139"><a href="#cb5-139"></a>::::</span>
<span id="cb5-140"><a href="#cb5-140"></a></span>
<span id="cb5-141"><a href="#cb5-141"></a>:::{.subtask}</span>
<span id="cb5-142"><a href="#cb5-142"></a>Adjust this range for a 12-day old chick and choose a mean $\mu_0$ for the weakly informed prior of the parameter $\mu.$ Justify your adjustment and choice with 1-3 sentences.</span>
<span id="cb5-143"><a href="#cb5-143"></a>:::</span>
<span id="cb5-144"><a href="#cb5-144"></a></span>
<span id="cb5-145"><a href="#cb5-145"></a>::::{.subrubric}</span>
<span id="cb5-146"><a href="#cb5-146"></a><span class="fu">### 12-day old chick weight range by intuition</span></span>
<span id="cb5-147"><a href="#cb5-147"></a></span>
<span id="cb5-148"><a href="#cb5-148"></a><span class="ss">* </span>The range is always above **...** and below **...**.</span>
<span id="cb5-149"><a href="#cb5-149"></a><span class="ss">* </span>Is the justification based on some sort of logic, even if you may disagree?</span>
<span id="cb5-150"><a href="#cb5-150"></a>:::: </span>
<span id="cb5-151"><a href="#cb5-151"></a></span>
<span id="cb5-152"><a href="#cb5-152"></a>Choosing the prior standard deviation for $\mu$ requires a little more caution; overconfident (i.e. narrow) priors can have a strong effect on your results,</span>
<span id="cb5-153"><a href="#cb5-153"></a>whereas less confident priors are more easily overcome with observed data.</span>
<span id="cb5-154"><a href="#cb5-154"></a>Given that overconfidence is a common human bias, a good intuition-based standard deviation should focus on eliminating the impossible values, rather than including the most likely values. </span>
<span id="cb5-155"><a href="#cb5-155"></a></span>
<span id="cb5-156"><a href="#cb5-156"></a>:::{.subtask}</span>
<span id="cb5-157"><a href="#cb5-157"></a>Choose a conservative lower and upper bound for the weight of any 12-day old chick, with the goal to exclude impossible values. Justify your choice with 1-3 sentences.</span>
<span id="cb5-158"><a href="#cb5-158"></a>:::</span>
<span id="cb5-159"><a href="#cb5-159"></a></span>
<span id="cb5-160"><a href="#cb5-160"></a>:::{.hint}</span>
<span id="cb5-161"><a href="#cb5-161"></a>Depending on your choice of range above for a "typical" chick, this range excluding the impossible values should be wider.</span>
<span id="cb5-162"><a href="#cb5-162"></a>:::</span>
<span id="cb5-163"><a href="#cb5-163"></a></span>
<span id="cb5-164"><a href="#cb5-164"></a>::::{.subrubric}</span>
<span id="cb5-165"><a href="#cb5-165"></a><span class="fu">### Prior standard deviation by intuition</span></span>
<span id="cb5-166"><a href="#cb5-166"></a></span>
<span id="cb5-167"><a href="#cb5-167"></a><span class="ss">* </span>Does the chosen range meet the following common sense criteria?</span>
<span id="cb5-168"><a href="#cb5-168"></a><span class="ss">  * </span>The range is always above **...** and below **...**.</span>
<span id="cb5-169"><a href="#cb5-169"></a><span class="ss">* </span>Is the justification based on some sort of logic, even if you may disagree?</span>
<span id="cb5-170"><a href="#cb5-170"></a>::::</span>
<span id="cb5-171"><a href="#cb5-171"></a></span>
<span id="cb5-172"><a href="#cb5-172"></a>A common technique to find a weakly informative prior is to have a standard deviation which is an order of magnitude (a factor of 10) larger than a plausible standard deviation of the data.</span>
<span id="cb5-173"><a href="#cb5-173"></a></span>
<span id="cb5-174"><a href="#cb5-174"></a>:::{.subtask}</span>
<span id="cb5-175"><a href="#cb5-175"></a>What do you think is a plausible standard deviation $\sigma_\text{plausible}$ of the weight of 12 days-old chicks, based on your ranges stated above? </span>
<span id="cb5-176"><a href="#cb5-176"></a>Under the above recommendation, what standard deviation $\sigma_0$ should you use for your prior for the mean weight $\mu$?</span>
<span id="cb5-177"><a href="#cb5-177"></a>:::</span>
<span id="cb5-178"><a href="#cb5-178"></a></span>
<span id="cb5-179"><a href="#cb5-179"></a>::::{.subrubric}</span>
<span id="cb5-180"><a href="#cb5-180"></a><span class="fu">#### Prior standard deviation by intuition</span></span>
<span id="cb5-181"><a href="#cb5-181"></a></span>
<span id="cb5-182"><a href="#cb5-182"></a><span class="ss">* </span>Do the two standard deviations meet the following common sense criteria?</span>
<span id="cb5-183"><a href="#cb5-183"></a><span class="ss">  - </span>Both values are **...**</span>
<span id="cb5-184"><a href="#cb5-184"></a><span class="ss">* </span>Given the choice of mean from above, the interval $(\mu_0 - 3\sigma_0, \mu_0 + 3\sigma_0)$ includes **...**.</span>
<span id="cb5-185"><a href="#cb5-185"></a>::::</span>
<span id="cb5-186"><a href="#cb5-186"></a></span>
<span id="cb5-187"><a href="#cb5-187"></a></span>
<span id="cb5-188"><a href="#cb5-188"></a>:::{.subtask}</span>
<span id="cb5-189"><a href="#cb5-189"></a>Write down in mathematical form the final prior for the mean weight $\mu$ you found using this prior definition technique.</span>
<span id="cb5-190"><a href="#cb5-190"></a>:::</span>
<span id="cb5-191"><a href="#cb5-191"></a></span>
<span id="cb5-192"><a href="#cb5-192"></a>::::{.subrubric}</span>
<span id="cb5-193"><a href="#cb5-193"></a><span class="fu">### Prior by intuition</span></span>
<span id="cb5-194"><a href="#cb5-194"></a></span>
<span id="cb5-195"><a href="#cb5-195"></a><span class="ss">* </span>Does the final prior exist in mathematical notation?</span>
<span id="cb5-196"><a href="#cb5-196"></a><span class="ss">* </span>Does the prior reflect the choices made above (i.e. $\mu_0, \sigma_0$)?</span>
<span id="cb5-197"><a href="#cb5-197"></a>::::</span>
<span id="cb5-198"><a href="#cb5-198"></a></span>
<span id="cb5-199"><a href="#cb5-199"></a><span class="fu">## Choosing a weakly informative prior using external references</span></span>
<span id="cb5-200"><a href="#cb5-200"></a></span>
<span id="cb5-201"><a href="#cb5-201"></a>Next, we'll use external references to pick the weakly informed prior. This technique is more general and doesn't assume you would have prior knowledge.</span>
<span id="cb5-202"><a href="#cb5-202"></a></span>
<span id="cb5-203"><a href="#cb5-203"></a>:::{.subtask}</span>
<span id="cb5-204"><a href="#cb5-204"></a>Consult a trustworthy source on the weight range of farm chickens, e.g. books, articles, a farmer friend. If the recommended values are for a fully grown chicken, make a reasonable adjustment for a 12-day old chick. What is the weight range of a 12-day old chicken? Cite your source and justify any adjustments you make to the reference range.</span>
<span id="cb5-205"><a href="#cb5-205"></a>:::</span>
<span id="cb5-206"><a href="#cb5-206"></a></span>
<span id="cb5-207"><a href="#cb5-207"></a>::::{.subrubric}</span>
<span id="cb5-208"><a href="#cb5-208"></a><span class="fu">### Weight range by reference</span></span>
<span id="cb5-209"><a href="#cb5-209"></a><span class="ss">* </span>Does the reference range meet the following common sense criteria?</span>
<span id="cb5-210"><a href="#cb5-210"></a><span class="ss">  * </span>The range is always above **...** and below **...**.</span>
<span id="cb5-211"><a href="#cb5-211"></a><span class="ss">* </span>Is there a citation? If an adjustment was made, was it justified by logic, even if you disagree?</span>
<span id="cb5-212"><a href="#cb5-212"></a>::::</span>
<span id="cb5-213"><a href="#cb5-213"></a></span>
<span id="cb5-214"><a href="#cb5-214"></a>:::{.subtask}</span>
<span id="cb5-215"><a href="#cb5-215"></a>Based on this reference range, what will you choose for the mean of our weakly informed prior? Justify your choice with 1-3 sentences.</span>
<span id="cb5-216"><a href="#cb5-216"></a>:::</span>
<span id="cb5-217"><a href="#cb5-217"></a></span>
<span id="cb5-218"><a href="#cb5-218"></a>::::{.subrubric}</span>
<span id="cb5-219"><a href="#cb5-219"></a><span class="fu">### Weight range by reference</span></span>
<span id="cb5-220"><a href="#cb5-220"></a></span>
<span id="cb5-221"><a href="#cb5-221"></a><span class="ss">* </span>Does the mean value meet the following common sense criteria?</span>
<span id="cb5-222"><a href="#cb5-222"></a><span class="ss">  * </span>The range is always above **...** and below **...**.</span>
<span id="cb5-223"><a href="#cb5-223"></a>::::</span>
<span id="cb5-224"><a href="#cb5-224"></a></span>
<span id="cb5-225"><a href="#cb5-225"></a>Next we choose the standard deviation of the prior. We could use the same technique as before, but we'll walk you through another common approach. Assume that $99.7\%$ of all 12-day old chicks fall into the reference range you found. Under our assumption of a normal distribution, this range will encompass values between $\mu_0 \pm 3\sigma_0$. </span>
<span id="cb5-226"><a href="#cb5-226"></a></span>
<span id="cb5-227"><a href="#cb5-227"></a>:::{.subtask}</span>
<span id="cb5-228"><a href="#cb5-228"></a>Assuming symmetry, use the mean you chose and either the upper or lower bound $b$ of your reference range to solve the correct version of the following equations to find your associated choice of $\sigma_0$: (show your work)</span>
<span id="cb5-229"><a href="#cb5-229"></a></span>
<span id="cb5-230"><a href="#cb5-230"></a><span class="ss">- </span>For upper bound $b_u$: $Pr(\mu_0 + 3\sigma_0 &lt; b_u) \approx 0.997$, solving for $\sigma_0$.</span>
<span id="cb5-231"><a href="#cb5-231"></a><span class="ss">- </span>For lower bound $b_l$: $Pr(\mu_0 - 3\sigma_0 &gt; b_l) \approx 0.997$, solving for $\sigma_0$.</span>
<span id="cb5-232"><a href="#cb5-232"></a>:::</span>
<span id="cb5-233"><a href="#cb5-233"></a></span>
<span id="cb5-234"><a href="#cb5-234"></a>::::{.subrubric}</span>
<span id="cb5-235"><a href="#cb5-235"></a><span class="fu">### Prior standard deviation by reference</span></span>
<span id="cb5-236"><a href="#cb5-236"></a></span>
<span id="cb5-237"><a href="#cb5-237"></a><span class="ss">* </span>Does the calculated $\sigma_0$ value meet the following common sense criteria?</span>
<span id="cb5-238"><a href="#cb5-238"></a><span class="ss">  * </span>The value is above **...** and below **...**.</span>
<span id="cb5-239"><a href="#cb5-239"></a><span class="ss">* </span>Did they show their work?</span>
<span id="cb5-240"><a href="#cb5-240"></a>::::</span>
<span id="cb5-241"><a href="#cb5-241"></a></span>
<span id="cb5-242"><a href="#cb5-242"></a>:::{.subtask}</span>
<span id="cb5-243"><a href="#cb5-243"></a>Write down in mathematical form the final prior for the mean weight $\mu$ you found using this prior definition technique.</span>
<span id="cb5-244"><a href="#cb5-244"></a>:::</span>
<span id="cb5-245"><a href="#cb5-245"></a></span>
<span id="cb5-246"><a href="#cb5-246"></a>::::{.subrubric}</span>
<span id="cb5-247"><a href="#cb5-247"></a><span class="fu">### Prior by reference</span></span>
<span id="cb5-248"><a href="#cb5-248"></a></span>
<span id="cb5-249"><a href="#cb5-249"></a><span class="ss">* </span>Does the final prior exist in mathematical notation?</span>
<span id="cb5-250"><a href="#cb5-250"></a><span class="ss">* </span>Does the prior reflect the choices made above (i.e. $\mu_0, \sigma_0$)?</span>
<span id="cb5-251"><a href="#cb5-251"></a>::::</span>
<span id="cb5-252"><a href="#cb5-252"></a></span>
<span id="cb5-253"><a href="#cb5-253"></a><span class="fu">## Non-normal priors</span></span>
<span id="cb5-254"><a href="#cb5-254"></a></span>
<span id="cb5-255"><a href="#cb5-255"></a>The previous steps all assumed we could use a prior which is normally distributed, but this may not always be the correct assumption to make. </span>
<span id="cb5-256"><a href="#cb5-256"></a></span>
<span id="cb5-257"><a href="#cb5-257"></a>:::{.subtask}</span>
<span id="cb5-258"><a href="#cb5-258"></a>Under what mathematical/statistical circumstances would a normal distributed prior not make sense? List at least one circumstance.  Are there values that the normal distribution can take on which would not make sense for some types of variables?</span>
<span id="cb5-259"><a href="#cb5-259"></a>:::</span>
<span id="cb5-260"><a href="#cb5-260"></a></span>
<span id="cb5-261"><a href="#cb5-261"></a>:::{.hint}</span>
<span id="cb5-262"><a href="#cb5-262"></a>Consider the nature of any variable you are trying to define a prior over.</span>
<span id="cb5-263"><a href="#cb5-263"></a>:::</span>
<span id="cb5-264"><a href="#cb5-264"></a></span>
<span id="cb5-265"><a href="#cb5-265"></a>::::{.subrubric}</span>
<span id="cb5-266"><a href="#cb5-266"></a><span class="fu">### Non-normal priors</span></span>
<span id="cb5-267"><a href="#cb5-267"></a></span>
<span id="cb5-268"><a href="#cb5-268"></a><span class="ss">* </span>Example cases include variables that **...** or variables that **...**</span>
<span id="cb5-269"><a href="#cb5-269"></a>::::</span>
<span id="cb5-270"><a href="#cb5-270"></a></span>
<span id="cb5-271"><a href="#cb5-271"></a><span class="fu">## Modeling diet effects on chicken weight</span></span>
<span id="cb5-272"><a href="#cb5-272"></a>    </span>
<span id="cb5-273"><a href="#cb5-273"></a>In addition to chick weights, the data also contains a categorical variable indicating which diet the chick received. In the data file, each column contains the measurements for a single chick at a given point of time.</span>
<span id="cb5-274"><a href="#cb5-274"></a></span>
<span id="cb5-275"><a href="#cb5-275"></a>In addition to the existing diets, we are interested in the quality of another box of feed (the fifth diet), which a farmer happened to find yesterday at a dark corner of his warehouse. To read in the data and select chicks with age of 12 days, and to have a peek at the first 6 rows, just use:</span>
<span id="cb5-276"><a href="#cb5-276"></a></span>
<span id="cb5-277"><a href="#cb5-277"></a>::::{.callout-important collapse=true}</span>
<span id="cb5-278"><a href="#cb5-278"></a><span class="fu"># Data inside, don't peek before you have set your priors!</span></span>
<span id="cb5-279"><a href="#cb5-279"></a>:::{.callout-important collapse=true}</span>
<span id="cb5-280"><a href="#cb5-280"></a><span class="fu"># Have you set your priors?</span></span>
<span id="cb5-283"><a href="#cb5-283"></a><span class="in">```{r}</span></span>
<span id="cb5-284"><a href="#cb5-284"></a><span class="co">#| message: false</span></span>
<span id="cb5-285"><a href="#cb5-285"></a><span class="fu">data</span>(<span class="st">"ChickWeight"</span>)</span>
<span id="cb5-286"><a href="#cb5-286"></a></span>
<span id="cb5-287"><a href="#cb5-287"></a>Chick12 <span class="ot">&lt;-</span> ChickWeight <span class="sc">|&gt;</span> <span class="fu">filter</span>(Time <span class="sc">==</span> <span class="dv">12</span>)</span>
<span id="cb5-288"><a href="#cb5-288"></a></span>
<span id="cb5-289"><a href="#cb5-289"></a><span class="fu">head</span>(Chick12)</span>
<span id="cb5-290"><a href="#cb5-290"></a><span class="in">```</span></span>
<span id="cb5-291"><a href="#cb5-291"></a>:::</span>
<span id="cb5-292"><a href="#cb5-292"></a>::::</span>
<span id="cb5-293"><a href="#cb5-293"></a></span>
<span id="cb5-294"><a href="#cb5-294"></a>In the following analysis, we will model the **weight of a chick at the age of 12 days**. We will use the following three Gaussian models:</span>
<span id="cb5-295"><a href="#cb5-295"></a></span>
<span id="cb5-296"><a href="#cb5-296"></a><span class="ss">-   </span>a separate model, in which each diet is modeled individually</span>
<span id="cb5-297"><a href="#cb5-297"></a><span class="ss">-   </span>a pooled model, in which all measurements are combined and there is no distinction between diets</span>
<span id="cb5-298"><a href="#cb5-298"></a><span class="ss">-   </span>a hierarchical model, which has a hierarchical structure as described in <span class="co">[</span><span class="ot">BDA3</span><span class="co">](https://users.aalto.fi/~ave/BDA3.pdf)</span> Section 11.6</span>
<span id="cb5-299"><a href="#cb5-299"></a></span>
<span id="cb5-300"><a href="#cb5-300"></a>As in the model described in the book, use the same weight standard deviation $\sigma$ for all the groups in the hierarchical model. In the separate model, however, use separate weight standard deviation $\sigma_d$ for each diet $d$. You should use weakly informative priors for all your models.</span>
<span id="cb5-301"><a href="#cb5-301"></a></span>
<span id="cb5-302"><a href="#cb5-302"></a>The provided Stan code below is given as an example of a separate model. Note that the author has left a comment expressing uncertainty about their prior choices. This separate model can be summarized mathematically as</span>
<span id="cb5-303"><a href="#cb5-303"></a>$$</span>
<span id="cb5-304"><a href="#cb5-304"></a>\begin{aligned}</span>
<span id="cb5-305"><a href="#cb5-305"></a>    \mu_{d} &amp;\sim \pi(\mu_d)&amp;&amp;\text{(diet-wise mean weight),}<span class="sc">\\</span></span>
<span id="cb5-306"><a href="#cb5-306"></a>    \sigma_d &amp;\sim \pi(\sigma_d)&amp;&amp;\text{(diet-wise standard deviation of diet-wise chicken weights)},<span class="sc">\\</span></span>
<span id="cb5-307"><a href="#cb5-307"></a>    w_{i,d} &amp;\sim N(\mu_d,\sigma_d)&amp;&amp;\text{(diet-wise chicken weights)}<span class="sc">\\</span></span>
<span id="cb5-308"><a href="#cb5-308"></a>\end{aligned}</span>
<span id="cb5-309"><a href="#cb5-309"></a>$$ {#eq-separate}</span>
<span id="cb5-310"><a href="#cb5-310"></a></span>
<span id="cb5-311"><a href="#cb5-311"></a>with priors </span>
<span id="cb5-312"><a href="#cb5-312"></a></span>
<span id="cb5-313"><a href="#cb5-313"></a>$$</span>
<span id="cb5-314"><a href="#cb5-314"></a>\begin{aligned}</span>
<span id="cb5-315"><a href="#cb5-315"></a>    \mu_{d} &amp;\sim N(0,10)&amp;&amp;\text{(adjust this) and}<span class="sc">\\</span></span>
<span id="cb5-316"><a href="#cb5-316"></a>    \sigma_d &amp;\sim\mathrm{exponential}(.02)&amp;&amp;\text{(you can keep this).}</span>
<span id="cb5-317"><a href="#cb5-317"></a>\end{aligned}</span>
<span id="cb5-318"><a href="#cb5-318"></a>$$ {#eq-separate-priors}</span>
<span id="cb5-319"><a href="#cb5-319"></a></span>
<span id="cb5-320"><a href="#cb5-320"></a>For the separate and the pooled models, use one of the weakly informative priors you have derived in 2.1) or 2.2) for the diet-wise mean weights </span>
<span id="cb5-321"><a href="#cb5-321"></a>$$\mu_d\sim \pi(\mu_d)=N(\mu_0,\sigma_0).$$</span>
<span id="cb5-322"><a href="#cb5-322"></a>For the hierarchical model, remember that the parameters in the priors for the diet-wise mean weights itself have to be parameters with their own prior distributions, in our case </span>
<span id="cb5-323"><a href="#cb5-323"></a>$$</span>
<span id="cb5-324"><a href="#cb5-324"></a>\begin{aligned}</span>
<span id="cb5-325"><a href="#cb5-325"></a>\mu_d &amp;\sim N(\mu,\tau)&amp;&amp;\text{(diet-wise mean weights)},<span class="sc">\\</span></span>
<span id="cb5-326"><a href="#cb5-326"></a>\mu &amp;\sim \pi(\mu)&amp;&amp;\text{(mean of prior for diet-wise mean weights) and}<span class="sc">\\</span></span>
<span id="cb5-327"><a href="#cb5-327"></a>\tau &amp;\sim \pi(\tau)&amp;&amp;\text{(standard deviation of prior for diet-wise mean weights).}</span>
<span id="cb5-328"><a href="#cb5-328"></a>\end{aligned}</span>
<span id="cb5-329"><a href="#cb5-329"></a>$$</span>
<span id="cb5-330"><a href="#cb5-330"></a></span>
<span id="cb5-331"><a href="#cb5-331"></a>Use the prior you have used for the diet-wise mean weights $\mu_d$ in the separate and pooled models for the prior on the mean of the prior for the diet-wise mean weights </span>
<span id="cb5-332"><a href="#cb5-332"></a>$$\mu \sim \pi(\mu) = N(\mu_0,\sigma_0)$$</span>
<span id="cb5-333"><a href="#cb5-333"></a>in the hierarchical model and use </span>
<span id="cb5-334"><a href="#cb5-334"></a>$$\tau \sim \pi(\tau) = \mathrm{exponential}(.02)$$ </span>
<span id="cb5-335"><a href="#cb5-335"></a>for the prior on the standard deviation of the prior for the diet-wise mean weights.</span>
<span id="cb5-336"><a href="#cb5-336"></a></span>
<span id="cb5-337"><a href="#cb5-337"></a><span class="in">```{.stan include="additional_files/assignment7/chickens_separate.stan"}</span></span>
<span id="cb5-338"><a href="#cb5-338"></a><span class="in">```</span></span>
<span id="cb5-339"><a href="#cb5-339"></a></span>
<span id="cb5-340"><a href="#cb5-340"></a></span>
<span id="cb5-341"><a href="#cb5-341"></a></span>
<span id="cb5-342"><a href="#cb5-342"></a></span>
<span id="cb5-343"><a href="#cb5-343"></a></span>
<span id="cb5-344"><a href="#cb5-344"></a>:::{.subtask}</span>
<span id="cb5-345"><a href="#cb5-345"></a>Describe the models with mathematical notation (as is done for the separate model above). Also describe in words the difference between the model and the other models.</span>
<span id="cb5-346"><a href="#cb5-346"></a>:::</span>
<span id="cb5-347"><a href="#cb5-347"></a></span>
<span id="cb5-348"><a href="#cb5-348"></a></span>
<span id="cb5-349"><a href="#cb5-349"></a></span>
<span id="cb5-350"><a href="#cb5-350"></a></span>
<span id="cb5-351"><a href="#cb5-351"></a></span>
<span id="cb5-352"><a href="#cb5-352"></a></span>
<span id="cb5-353"><a href="#cb5-353"></a></span>
<span id="cb5-354"><a href="#cb5-354"></a></span>
<span id="cb5-355"><a href="#cb5-355"></a>::::{.subrubric}</span>
<span id="cb5-356"><a href="#cb5-356"></a></span>
<span id="cb5-357"><a href="#cb5-357"></a><span class="ss">* </span>Are the models described using mathematical notation and the difference to other models described in words?</span>
<span id="cb5-358"><a href="#cb5-358"></a><span class="ss">  - </span>No equations and no description</span>
<span id="cb5-359"><a href="#cb5-359"></a><span class="ss">  - </span>Description but no equations</span>
<span id="cb5-360"><a href="#cb5-360"></a><span class="ss">  - </span>Equations but no description</span>
<span id="cb5-361"><a href="#cb5-361"></a><span class="ss">  - </span>Equations and description</span>
<span id="cb5-362"><a href="#cb5-362"></a>::::</span>
<span id="cb5-363"><a href="#cb5-363"></a></span>
<span id="cb5-364"><a href="#cb5-364"></a>:::{.subtask}</span>
<span id="cb5-365"><a href="#cb5-365"></a>Implement the models in Stan and include the code in the report. Use weakly informative priors for all of your models.</span>
<span id="cb5-366"><a href="#cb5-366"></a>:::</span>
<span id="cb5-367"><a href="#cb5-367"></a></span>
<span id="cb5-368"><a href="#cb5-368"></a>:::{.hint}</span>
<span id="cb5-369"><a href="#cb5-369"></a>When sampling from the posterior of the hierarchical model, you will very likely get a warning about divergent transitions. This tells you that the sampler is having difficulties in sampling the joint posterior and this may lead to biased inference. We will return to this in the next task.</span>
<span id="cb5-370"><a href="#cb5-370"></a>:::</span>
<span id="cb5-371"><a href="#cb5-371"></a></span>
<span id="cb5-372"><a href="#cb5-372"></a></span>
<span id="cb5-373"><a href="#cb5-373"></a></span>
<span id="cb5-374"><a href="#cb5-374"></a></span>
<span id="cb5-375"><a href="#cb5-375"></a></span>
<span id="cb5-376"><a href="#cb5-376"></a>::::{.subrubric}</span>
<span id="cb5-377"><a href="#cb5-377"></a><span class="fu">### All models</span></span>
<span id="cb5-378"><a href="#cb5-378"></a></span>
<span id="cb5-379"><a href="#cb5-379"></a><span class="ss">* </span>Is there a related Stan implementation?</span>
<span id="cb5-380"><a href="#cb5-380"></a><span class="ss">  - </span>No Stan model implemented</span>
<span id="cb5-381"><a href="#cb5-381"></a><span class="ss">  - </span>Stan model implemented, but it seems clearly wrong or broken</span>
<span id="cb5-382"><a href="#cb5-382"></a><span class="ss">  - </span>Seemingly valid Stan model implemented</span>
<span id="cb5-383"><a href="#cb5-383"></a>::::</span>
<span id="cb5-384"><a href="#cb5-384"></a></span>
<span id="cb5-385"><a href="#cb5-385"></a></span>
<span id="cb5-386"><a href="#cb5-386"></a></span>
<span id="cb5-387"><a href="#cb5-387"></a></span>
<span id="cb5-388"><a href="#cb5-388"></a></span>
<span id="cb5-389"><a href="#cb5-389"></a>:::{.subtask}</span>
<span id="cb5-390"><a href="#cb5-390"></a>Use the provided code in the template to</span>
<span id="cb5-391"><a href="#cb5-391"></a>plot the **posterior distribution of the mean of the weight measurements of the fourth diet** and comment on the possible differences you observe</span>
<span id="cb5-392"><a href="#cb5-392"></a>between the models.</span>
<span id="cb5-393"><a href="#cb5-393"></a>:::</span>
<span id="cb5-394"><a href="#cb5-394"></a></span>
<span id="cb5-395"><a href="#cb5-395"></a></span>
<span id="cb5-396"><a href="#cb5-396"></a></span>
<span id="cb5-397"><a href="#cb5-397"></a>::::{.subrubric}</span>
<span id="cb5-398"><a href="#cb5-398"></a><span class="ss">* </span>Is there a comparison plotted for the posteriors of the mean of diet 4? Does it look something like the model solution plot?</span>
<span id="cb5-399"><a href="#cb5-399"></a><span class="ss">  -   </span>No comparison plotted</span>
<span id="cb5-400"><a href="#cb5-400"></a><span class="ss">  -   </span>Comparison plotted but it clearly differs from the example</span>
<span id="cb5-401"><a href="#cb5-401"></a><span class="ss">  -   </span>Comparison plotted and it approximately matches the example</span>
<span id="cb5-402"><a href="#cb5-402"></a><span class="ss">* </span>Separate model: Is the result for the separate model discussed?</span>
<span id="cb5-403"><a href="#cb5-403"></a><span class="ss">  -   </span>The result is not discussed.</span>
<span id="cb5-404"><a href="#cb5-404"></a><span class="ss">  -   </span>There is some discussion, but it is not mentioned that **...**.</span>
<span id="cb5-405"><a href="#cb5-405"></a><span class="ss">  -   </span>The result is discussed and the separate model is recognised as **...**.</span>
<span id="cb5-406"><a href="#cb5-406"></a><span class="ss">* </span>Pooled model: Is the result for the pooled model discussed?</span>
<span id="cb5-407"><a href="#cb5-407"></a><span class="ss">  -   </span>The result is not discussed.</span>
<span id="cb5-408"><a href="#cb5-408"></a><span class="ss">  -   </span>There is some discussion, but it is not mentioned that **...**.</span>
<span id="cb5-409"><a href="#cb5-409"></a><span class="ss">  -   </span>The result is discussed and the pooled model is recognised as **...**.</span>
<span id="cb5-410"><a href="#cb5-410"></a><span class="ss">* </span>Hierarchical model: Is the result for the hierarchical model discussed?</span>
<span id="cb5-411"><a href="#cb5-411"></a><span class="ss">  -   </span>The result is not discussed.</span>
<span id="cb5-412"><a href="#cb5-412"></a><span class="ss">  -   </span>There is some discussion, but it is not mentioned that **...**.</span>
<span id="cb5-413"><a href="#cb5-413"></a><span class="ss">  -   </span>The result is discussed and the hierarchical model is recognised as **...**.</span>
<span id="cb5-414"><a href="#cb5-414"></a>::::</span>
<span id="cb5-415"><a href="#cb5-415"></a></span>
<span id="cb5-416"><a href="#cb5-416"></a>:::{.subtask}</span>
<span id="cb5-417"><a href="#cb5-417"></a>Use the provided code in the template to</span>
<span id="cb5-418"><a href="#cb5-418"></a>plot the **predictive distribution for another weight measurement from a chick having the fourth diet** and comment on the possible differences you observe</span>
<span id="cb5-419"><a href="#cb5-419"></a>between the models.</span>
<span id="cb5-420"><a href="#cb5-420"></a>:::</span>
<span id="cb5-421"><a href="#cb5-421"></a></span>
<span id="cb5-422"><a href="#cb5-422"></a></span>
<span id="cb5-423"><a href="#cb5-423"></a></span>
<span id="cb5-424"><a href="#cb5-424"></a>::::{.subrubric}</span>
<span id="cb5-425"><a href="#cb5-425"></a></span>
<span id="cb5-426"><a href="#cb5-426"></a><span class="ss">* </span>Is there a comparison plotted for the predictive distributions of the weight of a chick with diet 4? Does it look something like the model solution plot?</span>
<span id="cb5-427"><a href="#cb5-427"></a><span class="ss">  -   </span>No comparison plotted</span>
<span id="cb5-428"><a href="#cb5-428"></a><span class="ss">  -   </span>Comparison plotted but it clearly differs from the example</span>
<span id="cb5-429"><a href="#cb5-429"></a><span class="ss">  -   </span>Comparison plotted and it approximately matches the example</span>
<span id="cb5-430"><a href="#cb5-430"></a><span class="ss">* </span>Separate model: Is the result for the separate model discussed?</span>
<span id="cb5-431"><a href="#cb5-431"></a><span class="ss">  -   </span>The result is not discussed.</span>
<span id="cb5-432"><a href="#cb5-432"></a><span class="ss">  -   </span>There is some discussion, but it is not mentioned that **...**.</span>
<span id="cb5-433"><a href="#cb5-433"></a><span class="ss">  -   </span>The result is discussed and the separate model is recognised as **...**.</span>
<span id="cb5-434"><a href="#cb5-434"></a><span class="ss">* </span>Pooled model: Is the result for the pooled model discussed?</span>
<span id="cb5-435"><a href="#cb5-435"></a><span class="ss">  -   </span>The result is not discussed.</span>
<span id="cb5-436"><a href="#cb5-436"></a><span class="ss">  -   </span>There is some discussion, but it is not mentioned that **...**.</span>
<span id="cb5-437"><a href="#cb5-437"></a><span class="ss">  -   </span>The result is discussed and the pooled model is recognised as **...**.</span>
<span id="cb5-438"><a href="#cb5-438"></a><span class="ss">* </span>Hierarchical model: Is the result for the hierarchical model discussed?</span>
<span id="cb5-439"><a href="#cb5-439"></a><span class="ss">  -   </span>The result is not discussed.</span>
<span id="cb5-440"><a href="#cb5-440"></a><span class="ss">  -   </span>There is some discussion, but it is not mentioned that **...**.</span>
<span id="cb5-441"><a href="#cb5-441"></a><span class="ss">  -   </span>The result is discussed and the hierarchical model is recognised as **...**.</span>
<span id="cb5-442"><a href="#cb5-442"></a>::::</span>
<span id="cb5-443"><a href="#cb5-443"></a></span>
<span id="cb5-444"><a href="#cb5-444"></a>::: {.subtask}</span>
<span id="cb5-445"><a href="#cb5-445"></a>Use the provided code in the template to</span>
<span id="cb5-446"><a href="#cb5-446"></a>plot the **posterior distribution of the mean of the weight measurements of a new fifth diet** and comment on the possible differences you observe</span>
<span id="cb5-447"><a href="#cb5-447"></a>between the models.</span>
<span id="cb5-448"><a href="#cb5-448"></a>:::</span>
<span id="cb5-449"><a href="#cb5-449"></a></span>
<span id="cb5-450"><a href="#cb5-450"></a></span>
<span id="cb5-451"><a href="#cb5-451"></a></span>
<span id="cb5-452"><a href="#cb5-452"></a>::::{.subrubric}</span>
<span id="cb5-453"><a href="#cb5-453"></a><span class="ss">* </span>Is there a comparison plotted for the posterior distributions of the mean weight with a new diet? Does it look something like the model solution plot?</span>
<span id="cb5-454"><a href="#cb5-454"></a><span class="ss">  -   </span>No comparison plotted</span>
<span id="cb5-455"><a href="#cb5-455"></a><span class="ss">  -   </span>Comparison plotted but it clearly differs from the example</span>
<span id="cb5-456"><a href="#cb5-456"></a><span class="ss">  -   </span>Comparison plotted and it approximately matches the example</span>
<span id="cb5-457"><a href="#cb5-457"></a><span class="ss">* </span>Separate model: Is the result for the separate model discussed?</span>
<span id="cb5-458"><a href="#cb5-458"></a><span class="ss">  -   </span>The result is not discussed.</span>
<span id="cb5-459"><a href="#cb5-459"></a><span class="ss">  -   </span>There is some discussion, but it is not mentioned that **...**.</span>
<span id="cb5-460"><a href="#cb5-460"></a><span class="ss">  -   </span>The result is discussed and the separate model is recognised as **...**.</span>
<span id="cb5-461"><a href="#cb5-461"></a><span class="ss">  -   </span>In addition to the previous option, it is recognised that **...**.</span>
<span id="cb5-462"><a href="#cb5-462"></a><span class="ss">* </span>Pooled model: Is the result for the pooled model discussed?</span>
<span id="cb5-463"><a href="#cb5-463"></a><span class="ss">  -   </span>The result is not discussed.</span>
<span id="cb5-464"><a href="#cb5-464"></a><span class="ss">  -   </span>There is some discussion, but it is not mentioned that **...**.</span>
<span id="cb5-465"><a href="#cb5-465"></a><span class="ss">    -   </span>The result is discussed and the pooled model is recognised as **...**.</span>
<span id="cb5-466"><a href="#cb5-466"></a><span class="ss">    -   </span>In addition to the previous option, it is mentioned that **...**.</span>
<span id="cb5-467"><a href="#cb5-467"></a><span class="ss">* </span>Hierarchical model: Is the result for the hierarchical model discussed?</span>
<span id="cb5-468"><a href="#cb5-468"></a><span class="ss">  -   </span>The result is not discussed.</span>
<span id="cb5-469"><a href="#cb5-469"></a><span class="ss">    -   </span>There is some discussion, but it is not mentioned that **...**.</span>
<span id="cb5-470"><a href="#cb5-470"></a><span class="ss">    -   </span>The result is discussed and the hierarchical model is recognised as **...**.</span>
<span id="cb5-471"><a href="#cb5-471"></a>::::</span>
<span id="cb5-472"><a href="#cb5-472"></a></span>
<span id="cb5-473"><a href="#cb5-473"></a>:::{.subtask}</span>
<span id="cb5-474"><a href="#cb5-474"></a>For each model, report the **posterior expectation for the mean weight of diet 4 with a 90% credible interval**.</span>
<span id="cb5-475"><a href="#cb5-475"></a>:::</span>
<span id="cb5-476"><a href="#cb5-476"></a></span>
<span id="cb5-477"><a href="#cb5-477"></a>:::{.hint}</span>
<span id="cb5-478"><a href="#cb5-478"></a>See the example Stan codes in the demo <span class="co">[</span><span class="ot">Bayesian data analysis - CmdStanR demos: Comparison of $k$ groups with hierarchical models</span><span class="co">]</span>(http://avehtari.github.io/BDA_R_demos/demos_rstan/cmdstanr_demo.html#8_Comparison_of_(k)_groups_with_hierarchical_models) for the comparison of $k$ groups with and without the hierarchical structure.</span>
<span id="cb5-479"><a href="#cb5-479"></a>:::</span>
<span id="cb5-480"><a href="#cb5-480"></a></span>
<span id="cb5-481"><a href="#cb5-481"></a>::::{.subrubric}</span>
<span id="cb5-482"><a href="#cb5-482"></a><span class="ss">* </span>For the separate model, is the posterior 90% credible interval for the mean of the fourth diet close to: **...** (small/medium deviation is fine).</span>
<span id="cb5-483"><a href="#cb5-483"></a><span class="ss">  - </span>No or incorrect answer</span>
<span id="cb5-484"><a href="#cb5-484"></a><span class="ss">  - </span>Answer is only partially correct</span>
<span id="cb5-485"><a href="#cb5-485"></a><span class="ss">  - </span>Answers look correct</span>
<span id="cb5-486"><a href="#cb5-486"></a><span class="ss">* </span>For the pooled model, is the posterior 90% credible interval for the mean of the fourth diet close to: **...** (small/medium deviation is fine).</span>
<span id="cb5-487"><a href="#cb5-487"></a><span class="ss">  - </span>No answer</span>
<span id="cb5-488"><a href="#cb5-488"></a><span class="ss">  - </span>Answer is only partially correct</span>
<span id="cb5-489"><a href="#cb5-489"></a><span class="ss">  - </span>Answer looks correct</span>
<span id="cb5-490"><a href="#cb5-490"></a><span class="ss">* </span>For the hierarchical model, is the posterior 90% credible interval for the mean of the fourth diet close to: **...** (small/medium deviation is fine).</span>
<span id="cb5-491"><a href="#cb5-491"></a><span class="ss">  - </span>No answer</span>
<span id="cb5-492"><a href="#cb5-492"></a><span class="ss">  - </span>Answer is only partially correct.</span>
<span id="cb5-493"><a href="#cb5-493"></a><span class="ss">  - </span>Answers look correct.</span>
<span id="cb5-494"><a href="#cb5-494"></a></span>
<span id="cb5-495"><a href="#cb5-495"></a>::::</span>
<span id="cb5-496"><a href="#cb5-496"></a></span>
<span id="cb5-497"><a href="#cb5-497"></a><span class="fu"># Hierarchical model with BRMS (3p)</span></span>
<span id="cb5-498"><a href="#cb5-498"></a></span>
<span id="cb5-499"><a href="#cb5-499"></a></span>
<span id="cb5-500"><a href="#cb5-500"></a>:::{.callout-important}</span>
<span id="cb5-501"><a href="#cb5-501"></a></span>
<span id="cb5-502"><a href="#cb5-502"></a>We have made changes to the assignment text and some of the rubrics to make it clearer.</span>
<span id="cb5-503"><a href="#cb5-503"></a></span>
<span id="cb5-504"><a href="#cb5-504"></a>:::</span>
<span id="cb5-505"><a href="#cb5-505"></a></span>
<span id="cb5-506"><a href="#cb5-506"></a>The goal of this task is to discuss an alternative parameterisation of hierarchical models and introduce the <span class="in">`brms`</span>-package.</span>
<span id="cb5-507"><a href="#cb5-507"></a></span>
<span id="cb5-508"><a href="#cb5-508"></a><span class="co">[</span><span class="ot">`brms`</span><span class="co">](https://paul-buerkner.github.io/brms/)</span> is a high-level interface for Stan providing tools to create a wide range of Bayesian models, including hierarchical ones. In the previous section, you might have noted that with the hierarchical implementation of the model there may be divergent transitions during the sampling from the posterior. This is related to <span class="co">[</span><span class="ot">Neal's funnel</span><span class="co">](https://mc-stan.org/docs/stan-users-guide/reparameterisation.html)</span>, where the sampling algorithm would need to change the step size in order to effectively sample the posterior. One trick to improve sampling is to use an alternative parameterisation for the model. This parameterisation is called the non-centered parameterisation (@eq-non-centered) and often it can help with the divergent transitions. </span>
<span id="cb5-509"><a href="#cb5-509"></a></span>
<span id="cb5-510"><a href="#cb5-510"></a>In short, we sample parameters from a distribution with a potentially easier geometry for the sampler to explore efficiently and then transform those values to the joint distribution of interest.</span>
<span id="cb5-511"><a href="#cb5-511"></a></span>
<span id="cb5-512"><a href="#cb5-512"></a>The noncentered parameterisation for the hierarchical model using the diet-wise helper parameter $z_d$ becomes</span>
<span id="cb5-513"><a href="#cb5-513"></a></span>
<span id="cb5-514"><a href="#cb5-514"></a>$$</span>
<span id="cb5-515"><a href="#cb5-515"></a>\begin{aligned}</span>
<span id="cb5-516"><a href="#cb5-516"></a>z_d &amp;\sim \operatorname{normal}(0, 1)&amp;&amp;\text{(diet-wise helper parameter)},<span class="sc">\\</span></span>
<span id="cb5-517"><a href="#cb5-517"></a>\mu_d &amp;= \mu + z_d \tau&amp;&amp;\text{(diet-wise mean weight)},<span class="sc">\\</span></span>
<span id="cb5-518"><a href="#cb5-518"></a>\mu &amp;\sim \pi(\mu)&amp;&amp;\text{(mean of prior for diet-wise mean weights),}<span class="sc">\\</span></span>
<span id="cb5-519"><a href="#cb5-519"></a>\tau &amp;\sim \pi(\tau)&amp;&amp;\text{(standard deviation of prior for diet-wise mean weights),}<span class="sc">\\</span></span>
<span id="cb5-520"><a href="#cb5-520"></a>\sigma &amp;\sim \pi(\sigma)&amp;&amp;\text{(standard deviation of diet-wise chicken weights) and},<span class="sc">\\</span></span>
<span id="cb5-521"><a href="#cb5-521"></a>w_{i, d} &amp;\sim \operatorname{normal}(\mu_d, \sigma)&amp;&amp;\text{(chicken weights)}.<span class="sc">\\</span></span>
<span id="cb5-522"><a href="#cb5-522"></a>\end{aligned}</span>
<span id="cb5-523"><a href="#cb5-523"></a>$$ {#eq-non-centered}</span>
<span id="cb5-524"><a href="#cb5-524"></a></span>
<span id="cb5-525"><a href="#cb5-525"></a>The hierarchical models made with <span class="in">`brms`</span> use this non-centered parameterisation. Your tasks are the following:</span>
<span id="cb5-526"><a href="#cb5-526"></a></span>
<span id="cb5-527"><a href="#cb5-527"></a>:::{.subtask letter=a}</span>
<span id="cb5-528"><a href="#cb5-528"></a>Use the function in the template to make a scatter plot of the posterior draws given the hierarchical model of the population level standard deviation parameter $\tau$ and the mean parameter of the fourth diet, $\mu_4$. The possible divergent transitions are highlighted in red. In the report show the plot and comment if there are any divergent transitions.</span>
<span id="cb5-529"><a href="#cb5-529"></a>:::</span>
<span id="cb5-530"><a href="#cb5-530"></a></span>
<span id="cb5-531"><a href="#cb5-531"></a></span>
<span id="cb5-532"><a href="#cb5-532"></a></span>
<span id="cb5-533"><a href="#cb5-533"></a>:::{.subrubric}</span>
<span id="cb5-534"><a href="#cb5-534"></a><span class="ss">* </span>Is there a scatter plot of $\sigma_0$ and $\mu_4$ and some comments provided in the report?</span>
<span id="cb5-535"><a href="#cb5-535"></a><span class="ss">  - </span>No scatter plot or comments</span>
<span id="cb5-536"><a href="#cb5-536"></a><span class="ss">  - </span>The scatter plot is included, and divergent transitions are visible, but not commented on.</span>
<span id="cb5-537"><a href="#cb5-537"></a><span class="ss">  - </span>The scatter plot and comments on the divergences are included.</span>
<span id="cb5-538"><a href="#cb5-538"></a>:::</span>
<span id="cb5-539"><a href="#cb5-539"></a></span>
<span id="cb5-540"><a href="#cb5-540"></a>To sample from the posterior given the same model using <span class="in">`brms`</span>, in the template set the weakly informative priors for the hierarchical model you used in the previous task. <span class="in">`brms`</span> has an internal convention to name model parameters and the parameter names from @eq-non-centered map into <span class="in">`brms`</span> names with the following logic:</span>
<span id="cb5-541"><a href="#cb5-541"></a></span>
<span id="cb5-542"><a href="#cb5-542"></a><span class="ss"> - </span>$\mu$ corresponds to <span class="in">`class="Intercept"`</span></span>
<span id="cb5-543"><a href="#cb5-543"></a><span class="ss"> - </span>$\tau$ corresponds to <span class="in">`class="sd"`</span>,</span>
<span id="cb5-544"><a href="#cb5-544"></a><span class="ss"> - </span>$\sigma$ corresponds to <span class="in">`class="sigma"`</span>.</span>
<span id="cb5-545"><a href="#cb5-545"></a> </span>
<span id="cb5-546"><a href="#cb5-546"></a></span>
<span id="cb5-547"><a href="#cb5-547"></a>:::{.subtask}</span>
<span id="cb5-548"><a href="#cb5-548"></a>Replace <span class="in">`normal(0,10)`</span> in the <span class="in">`brm`</span> call in the template with your prior for the population mean </span>
<span id="cb5-549"><a href="#cb5-549"></a>$$\mu \sim \pi(\mu) = N(\mu_0,\sigma_0)$$ </span>
<span id="cb5-550"><a href="#cb5-550"></a>you have derived in 2). Then, run the code chunk to sample from the posterior of the hierarchical model using <span class="in">`brms`</span>.</span>
<span id="cb5-551"><a href="#cb5-551"></a>:::</span>
<span id="cb5-552"><a href="#cb5-552"></a></span>
<span id="cb5-553"><a href="#cb5-553"></a></span>
<span id="cb5-554"><a href="#cb5-554"></a></span>
<span id="cb5-555"><a href="#cb5-555"></a>::: {.subrubric}</span>
<span id="cb5-556"><a href="#cb5-556"></a><span class="ss">* </span>Is the <span class="in">`brms`</span> code shown and do the priors agree with the priors specified above?</span>
<span id="cb5-557"><a href="#cb5-557"></a>:::</span>
<span id="cb5-558"><a href="#cb5-558"></a></span>
<span id="cb5-559"><a href="#cb5-559"></a>:::{.subtask}</span>
<span id="cb5-560"><a href="#cb5-560"></a>Report the **posterior expectation for the mean weight of diet 4 $\mu_4$ with a 90% credible interval**, using the code block in the template. How does it compare with your results from the first task?</span>
<span id="cb5-561"><a href="#cb5-561"></a>:::</span>
<span id="cb5-562"><a href="#cb5-562"></a></span>
<span id="cb5-563"><a href="#cb5-563"></a></span>
<span id="cb5-564"><a href="#cb5-564"></a></span>
<span id="cb5-565"><a href="#cb5-565"></a>::: {.subrubric}</span>
<span id="cb5-566"><a href="#cb5-566"></a><span class="ss">* </span>Given the <span class="in">`brms`</span> model, is the posterior 90% credible interval for the mean of the fourth diet close to: **...**(small/medium deviation is fine).</span>
<span id="cb5-567"><a href="#cb5-567"></a><span class="ss">  - </span>No answer</span>
<span id="cb5-568"><a href="#cb5-568"></a><span class="ss">  - </span>Answer is only partially correct.</span>
<span id="cb5-569"><a href="#cb5-569"></a><span class="ss">  - </span>Answers look correct.</span>
<span id="cb5-570"><a href="#cb5-570"></a>:::</span>
<span id="cb5-571"><a href="#cb5-571"></a></span>
<span id="cb5-572"><a href="#cb5-572"></a>:::{.subtask}</span>
<span id="cb5-573"><a href="#cb5-573"></a>Use the code in the template to make a **scatter plot of the group standard deviation parameter $\tau$ and group specific mean parameter**. </span>
<span id="cb5-574"><a href="#cb5-574"></a>:::</span>
<span id="cb5-575"><a href="#cb5-575"></a></span>
<span id="cb5-576"><a href="#cb5-576"></a></span>
<span id="cb5-577"><a href="#cb5-577"></a></span>
<span id="cb5-578"><a href="#cb5-578"></a>::: {.subrubric}</span>
<span id="cb5-579"><a href="#cb5-579"></a><span class="ss">* </span>Is there a scatter plot of $\tau$ and $\mu_4$ and some comments provided in the report?</span>
<span id="cb5-580"><a href="#cb5-580"></a><span class="ss">  - </span>No scatter plot or comments</span>
<span id="cb5-581"><a href="#cb5-581"></a><span class="ss">  - </span>The scatter plot is included, and divergent transitions are visible, but not commented on.</span>
<span id="cb5-582"><a href="#cb5-582"></a><span class="ss">  - </span>The scatter plot and comments on the divergences are included.</span>
<span id="cb5-583"><a href="#cb5-583"></a>:::</span>
<span id="cb5-584"><a href="#cb5-584"></a></span>
<span id="cb5-585"><a href="#cb5-585"></a>:::{.subtask}</span>
<span id="cb5-586"><a href="#cb5-586"></a>In your report, address the following questions based on the plots you made for both parameterisations:</span>
<span id="cb5-587"><a href="#cb5-587"></a></span>
<span id="cb5-588"><a href="#cb5-588"></a><span class="ss"> - </span>Which of the parameterisations resulted in fewer divergent transitions?</span>
<span id="cb5-589"><a href="#cb5-589"></a><span class="ss"> - </span>Comment for both parameterisations: for which kind of values of $\tau$, do the divergent transitions occur (if there are any)? It also might be that no clear pattern can be seen.</span>
<span id="cb5-590"><a href="#cb5-590"></a><span class="ss"> - </span>Does centered parameterisation have problems sampling from some specific region of the parameter space compared to the non-centered parameterisation.</span>
<span id="cb5-591"><a href="#cb5-591"></a>:::</span>
<span id="cb5-592"><a href="#cb5-592"></a>::: {.subrubric}</span>
<span id="cb5-593"><a href="#cb5-593"></a><span class="ss">* </span>Has it been discussed which parameterisation resulted in fewer divergent transitions?</span>
<span id="cb5-594"><a href="#cb5-594"></a><span class="ss">* </span>Has it been discussed for which values of $\tau$ the divergences occurred?</span>
<span id="cb5-595"><a href="#cb5-595"></a><span class="ss">* </span>Has it been discussed whether/where the centered parameterisation has problems sampling?</span>
<span id="cb5-596"><a href="#cb5-596"></a>:::</span>
<span id="cb5-597"><a href="#cb5-597"></a></span>
<span id="cb5-598"><a href="#cb5-598"></a>{{&lt; include includes/_overall_quality.md &gt;}}</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>