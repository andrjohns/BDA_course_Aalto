cd /work
git config --global --add safe.directory /work
git config --global user.name "avehtari"
git config --global user.email "aki.vehtari@aalto.fi"
git checkout master
rmdfiles=$(git diff --name-only HEAD^ | grep '[.]*Rmd$')
# qmdfiles=$(git diff --name-only HEAD^ | grep '[.]*qmd$')
if [ -n "${rmdfiles}" ]; then while read -r filename; do   echo "$filename"; Rscript -e "rmarkdown::render('$filename')";   done <<< "$rmdfiles"; fi
# if [ -n "${qmdfiles}" ]; then while read -r filename; do   echo "$filename"; quarto render $filename;   done <<< "$qmdfiles"; fi
diff_assignments=$(git diff --name-only HEAD^ | grep '^assignments/')
if [ -n "${diff_assignments}" ]; then
  echo "Rendering assignments using quarto"
  cd assignments
  quarto install tinytex > /dev/null
  quarto render .
  cd ..
fi

